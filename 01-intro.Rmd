# Getting started with R and RStudio

Although R is not new, it's popularity has increased rapidly over the last 10 years or so (see [here][r4stats] for some interesting data). It was originally created and developed by Ross Ihaka and Robert Gentleman during the 1990's with the first stable version released in 2000. Nowadays R is currently developed and maintained by the R Development Core Team. So, why has R become so popular and why should you learn how to use it? Some reasons include: 

- R is open source and freely available. 
- R is available for Windows, Mac and Linux operating systems.
- R has an extensive and coherent set of tools for statistical analysis.
- R has an extensive and highly flexible graphical facility capable of producing publication quality figures.
- R has an expanding set of freely available ‘packages’ to extend R's capabilities. 
- R has an extensive support network with numerous online and freely available documents.

All of the reasons above are great reasons to use R. However, in our opinion, the single biggest reason to use R is that it facilitates robust and reproducible research practices. In contrast to more traditional 'point and click' software, writing R code to perform your analysis ensures you have a permanent and accurate record of all the methods (and decisions) you made whilst analysing your data. You are then able to share this code (and your data) with other researchers who will be able to reproduce your analysis exactly.   

## Installing R

To get up and running the first thing you need to do is install R. R is freely available for Windows, Mac and Linux operating systems from the [Comprehensive R Archive Network (CRAN) website][cran]. For Windows and Mac users I suggest you download and install the precompiled binary versions. 

**For Windows users** select 'Download R for Windows' link and then click on the 'base' link and finally the download link 'Download R 3.X.X for Windows' (where 3.X.X is the latest version of the binary - 3.6.1 at the time of writing). This will begin the download of the '.exe' installation file. When the download has completed double click on the R executable file and follow the on-screen instructions. Full installation instructions can be found at the [CRAN website][cran-windows].   

**For Mac users** select the '[Download R for (Mac) OS X][cran-mac]' link. The binary can be downloaded by selecting the 'R-3.X.X.pkg' (R-3.6.1.pkg at the time of writing). Once downloaded, double click on the file icon and follow the on-screen instructions to guide you through the necessary steps. See the '[R for Mac OS X][cran-mac-faq] FAQ' for further information on installation.

**For Linux users**, the installation method will depend on which flavour of linux you are using. There are reasonably comprehensive instruction [here][cran-linux] for Debian, Redhat, Suse  and Ubuntu. In most cases you can just use your OS package manager to install R from the official repository. On Ubuntu fire up a shell (console) and use (you will need root permission to do this):

```{block}
    sudo apt update
    sudo apt install r-base r-base-dev
```

which will install base R and also the development version of base R (you only need this if you want to compile R packages from source but it doesn't hurt to have it). 

If you receive an error after running the code above you may need to add a 'source.list' entry to your etc/apt/sources.list file. To do this open the /etc/apt/sources.list file in your favourite text editor (gedit, vim, nano etc) and add the following line (you will need root permission to do this):

```{block }
    deb https://cloud.r-project.org/bin/linux/ubuntu disco-cran35/
```

This is the source.list for the latest version of Ubuntu (19.04 Disco Dingoat the time of writing). If you're using an earlier version of Ubuntu then replace the source.list entry to the one which corresponds to the version of Ubuntu you are using (see [here][cran-ubuntu] for an up to date list). Once you have done this then re-run the apt commands above and you should be good to go.

Whichever operating system you're using, once you have installed R you need to check its working properly. The easiest way to do this is to start R by double clicking on the R icon (Windows or Mac) or by typing `R` into the console (Linux). You should see the R console and you should be able to type R commands into the console. Try typing the following R code and then press enter (don't worry of you don't understand this - we're just checking if R works)

A plot of the numbers 1 to 10 on both the x and y axes should appear. If you see this, you're good to go. If not then I suggest you make a note of any errors produced and then use Google to troubleshoot). 

```{r, out.width="75%", fig.align="center", fig.cap="plot to test R installation"}
plot(1:10)
```

\  

## Installing RStudio

Whilst its eminently possible to just use the base installation of R (many people do), we will be using a popular **I**ntegrated **D**evelopment **E**nvironment (IDE) called RStudio. RStudio can be thought of as an add-on to R which provides a more user-friendly interface, incorporating the R console, script editor and other useful functionality (like R markdown and Git Hub integration). You can find more information about [RStudio here][rstudio]. 

RStudio is freely available for Windows, Mac and Linux operating systems and can be downloaded from the [RStudio site][rstudio-download]. You should select the 'RStudio Desktop' version. Note: you must install R before you install RStudio (see previous section for details).

**For Windows and Mac users** you should be presented with the appropriate link for downloading. Click on this link and once downloaded run the installer and follow the instructions. If you don't see the link then scroll down to the 'All Installers' section and choose the link manually. 

**For linux users** scroll down to the 'All Installers' section and choose the appropriate link to download the binary for your Linux operating system. RStudio for Ubuntu (and Debian) is available as a `*.deb`  package. The easiest way to install `deb` files on Ubuntu is by using the `gdebi` command. If `gdebi` is not available on your system you can install it by executing the following command in the console (you will need root permission to do this) 

```{block}
    sudo apt update
    sudo apt install gdebi-core
```

To install the `*.deb` file navigate to where you downloaded the file and then enter the following command with root permission

```{block}
    sudo gdebi rstudio-xenial-1.2.5XXX-amd64.deb
```

where '-1.2.5XXX' is the current version for Ubuntu (rstudio-xenial-1.2.5019-amd64.deb at the time of writing). You can then start RStudio from the console by simply typing

```{block}
    rstudio
```

or you can create a shortcut on your Desktop for easy startup. 

Once installed, you can check everything is working by starting up RStudio (you don't need to start R as well, just RStudio). You should see something like the image below (there might only be 3 windows when you first start RStudio, don't worry, we'll get to this in a bit). 

\  

```{r rstudio, echo=FALSE, out.width="75%", fig.align="center", fig.cap="RStudio on Mac OS X"}
knitr::include_graphics(path = "images/rstudio.png")
```

\  

## Alternatives to RStudio

Although RStudio is becoming increasingly popular it might not be the best choice for everyone and you certainly don't have to use it to use R effectively. Rather than using an 'all in one' IDE many people choose to use R and a separate script editor to write and execute R code. If you're not familiar with what a script editor is, you can think of it as a bit like a word processor but specifically designed for writing code. Happily, there are many script editors freely available so feel free to download and experiment until you find one you like. Some script editors are only available for certain operating systems and not all are specific to R. Suggestions for script editors are:

**For windows users**

- [Tinn-R][tinn-r] 
- [Atom][atom]
- [Notepad++][notepad]

**For Mac users**

- [TextMate][textmate] 
- [Atom][atom]
- [MacVim][macvim]

**For Linux users**

- gedit (comes with Ubuntu already)
- [Atom][atom
- vim/nano (console based editors)

Which one you choose is up to you. One of the great things about R is that *YOU* get to choose how you want to use R

## RStudio orientation

When you open R studio for the first time you should see the following layout: 

\  

```{r rstudio_start, echo=FALSE, out.width="75%", fig.align="center"}
knitr::include_graphics(path = "images/rstudio_start.png")
```

\  

The large window (aka pane) on the left is the **Console** window. The window on the top right is the **Environment / History / Files** pane and the bottom left window is the **Plots / Help / Viewer** window. We will discuss each of these panes in turn below. You can customise the location of each pane by clicking on the 'Tools' menu then selecting Global Options --> Pane Layout. You can resize the panes by clicking and dragging the middle of the window borders in the direction you want. There are a plethora of other ways to [customise RStudio][rstudio-customise].

### Console

The console is the workhorse of R. This is where R evaluates all the code you write and stores all the objects (data for example) you create. You can type R code directly into the console at the command line prompt, `>`. For example, if you type `2 + 2` into the console you should obtain the answer `4` (reassuringly). Don't worry about the `[1]` at the start of the line for now. 

\  

```{r rstudio_console, echo=FALSE, out.width="75%", fig.align="center"}
knitr::include_graphics(path = "images/rconsole_eval.png")
```

\  

However, once you start writing more R code this becomes rather cumbersome. Instead of typing R code directly into the console a better approach is to create an R script. An R script is just a plain text file with a `.R` file extension which contains your lines of R code. These lines of code are then sourced into the R console line by line. To create a new R script click on the 'File' menu then select New File --> R Script.   

\  

```{r rstudio_newscript, echo=FALSE, out.width="75%", fig.align="center"}
knitr::include_graphics(path = "images/new_script.png")
```

\  

Notice that you have a new window (called the Source pane) in the top left of RStudio and the console is now in the bottom left position. The new window is a script editor and where you will write your code.  

\  

```{r rstudio_new, echo=FALSE, out.width="75%", fig.align="center"}
knitr::include_graphics(path = "images/rstudio_new.png")
```

\  

To source your code from your script editor to the console simply place your cursor on the line of code and then click on the 'Run' button in the top right of the script editor pane. 

\  

```{r rstudio_run, echo=FALSE, out.width="75%", fig.align="center"}
knitr::include_graphics(path = "images/rstudio_run.png")
```

\  

You should see the result in the console window. If clicking on the 'Run' button starts to become tiresome you can use the keyboard shortcut 'ctrl + enter' (on Windows and Linux) or 'cmd + enter' (on Mac). You can save your R scripts as a `.R` file by selecting the 'File' menu and clicking on save. Notice that the file name in the tab will turn red to remind you that you have unsaved changes. To open your R script in RStudio select the 'File' menu and then 'Open File...'. Although R scripts are saved with a `.R` extension they are actually just plain text files which can be opened with any text editor. 

A quick note or two about R scripts. Unless you're doing something really quick and dirty I suggest that you always write your code as an R script. R scripts are what make R so useful. Not only do you have a complete record of your analysis, from data manipulation, visualisation and statistical analysis, you can also share this code (and data) with friends, colleagues and importantly when you submit and publish your research to a journal. With this in mind, make sure you include in your R script all the information required to make your work reproducible (author names, dates, sampling design etc). This information could be included as a series of comments `#` or, even better, as code incorporated with commentary into an [R markdown][rmarkdown] document. How you write your code is more or less up to you although your goal should be to make it as easy to read as possible. You can find a few style guides for writing readable R code [here][style-google] and [here][style-tidy].         

\  

### Environment / History / Files

The Environment / History / Files window shows you lots of useful information. You can access each component by clicking on the appropriate tab in the pane.

- The 'Environment' tab displays all the objects you have created in the current (global) environment. These objects can be things like data you have imported or functions you have written. Objects can be displayed as a List or in Grid format by selecting your choice from the drop down button on the top right of the window. If you're in the Grid format you can remove objects from the environment by placing a tick in the empty box next to the object name and then click on the broom icon. There's also an 'Import Dataset' button which will import data saved in a variety of file formats. However, I would suggest that you don't use this approach to import your data as it's not reproducible and therefore not robust (see Chapter 3 for more details).        

- The 'History' tab simply contains a list of all the commands you have entered into the R console. You can search back through your history for the line of code you have forgotten, send selected code back to the console or Source window. I usually never use this as I always refer back to my R script.  

- The 'Files' tab lists all external files and directories in the current working directory on your computer. It works like file explorer (Windows) or Finder (Mac). You can open, copy, rename, move and delete files listed in the window.    
 
\  

### Plots / Help / Viewer

- The 'Plots' tab is where all the plots you create in R are displayed (unless you tell R otherwise). You can 'zoom' into the plots to make them larger and scroll back through previously created plots using the arrow buttons. There is also the option of exporting plots to an external file using the 'Export' drop down menu. Plots can be exported in various file formats such as jpeg, png, pdf, tiff or copied to the clipboard (although you are probably better off using the appropriate R functions to do this - see Chapter 4 for more details). 

- The 'Help' tab displays the R help documentation for any function. We will go over how to view the help files and how to search for help in Chapter 2.

- The 'Viewer' tab displays local web content such as web graphics generated by some packages. 

## R packages

The base installation of R comes with many useful packages as standard. However, as you start using R for more diverse projects (and as your own use of R evolves) you will find that there comes a time when you will need to extend R's capabilities. Happily, many thousands of R users have developed useful code and shared this code as installable packages. These packages can be installed from a variety of sources but the most popular are [CRAN][cran-packages], [Bioconductor][bioconductor] and [GitHub][github]. Currently, CRAN hosts over 15000 packages and is the official repository for user contributed R packages. Bioconductor provides open source software oriented towards bioinformatics and hosts over 1800 R packages. GitHub is a website that hosts git repositories for all sorts of software and projects (not just R). Often, cutting edge developement versions of R packages are hosted on GitHub so if you need all the new bells and whistles then this may be an option. Hoever, a potential downside of using a developemnt version of an R package is that it might not be as stable as the version hosted on CRAN (it's in developement!) and updating will require additional work. 

### CRAN packages

To install a package from CRAN you can use the `install.packages()` function. For example if you want to install the `devtools` package enter the following code into the console window of RStudio

```{r, echo = TRUE, eval=FALSE}
install.packages('devtools', dependencies = TRUE)
```

You may be asked to select a CRAN mirror, just select '0-cloud' or a mirror near to your location. The `dependencies = TRUE` argument ensures that additional packages that are required will also be installed.

Its good practice to occasionally update your previously installed packages to get access to new functionality and bug fixes. To update CRAN packages you can use the `update.packages()` function (you will need a working internet connection for this)

```{r, echo = TRUE, eval=FALSE}
update.packages(ask = FALSE)
```

The `ask = FALSE` argument avoids having to confirm every package download which can be a pain if you have many packages installed. 

### Bioconductor packages

To install packages from Bioconductor the process is a [little different][bioc-install]. You first need to install the `BiocManager` package. You only need to do this once unless you subsequently reinstall or upgrade R

```{r, echo=TRUE, eval=FALSE}
install.packages('BiocManager', dependencies = TRUE)
```

Once the BiocManager package has been installed you can either install all of the 'core' Bioconductor packages with 

```{r, echo=TRUE, eval=FALSE}
BiocManager::install()
```

or install specific packages such as the 'GenomicRanges' and 'edgeR' packages

```{r, echo=TRUE, eval=FALSE}
BiocManager::install(c("GenomicRanges", "edgeR"))
```

To update Bioconductor packages just use the `BiocManager::install()` function

```{r, echo=TRUE, eval=FALSE}
BiocManager::install(ask = FALSE)
```

Again, the `ask = FALSE` argument avoids having to confirm every package download which can be a pain if you have many packages installed.

### GitHub packages

There are multiple options for installing packages hosted on GitHub. Perhaps the most common method is to use the `install_github()` function from the `devtools` package (you installed this package previously). Before you use the function you will need to know the GitHub user name of the repository owner and also the name of the repository. For example, to install the development version of `dplyr` from Hadley Wickham the repository owner username is 'tidyverse' and the repository name is 'dplyr' (just Google 'github dplyr')

```{r, echo=TRUE, eval=FALSE}
devtools::install_github('tidyverse/dplyr')
```

The safest way (that we know of) to update a package installed from GitHub is to just reintsall it using the above command.   

```{r links, child="links.md"}
```
