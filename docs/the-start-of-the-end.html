<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 The start of the end | A Introduction to R</title>
  <meta name="description" content="An Introduction to R" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 The start of the end | A Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to R" />
  <meta name="github-repo" content="alexd106/Rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 The start of the end | A Introduction to R" />
  
  <meta name="twitter:description" content="An Introduction to R" />
  

<meta name="author" content="Alex Douglas, Francesca Mancini, Deon Roos, Ana Couto &amp; David Lusseau" />


<meta name="date" content="2019-12-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="beginning-at-the-end.html"/>
<link rel="next" href="stats-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started-with-r-and-rstudio.html"><a href="getting-started-with-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="install-r.html"><a href="install-r.html"><i class="fa fa-check"></i><b>1.1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="install-r.html"><a href="install-r.html#windows-users"><i class="fa fa-check"></i><b>1.1.1</b> Windows users</a></li>
<li class="chapter" data-level="1.1.2" data-path="install-r.html"><a href="install-r.html#mac-users"><i class="fa fa-check"></i><b>1.1.2</b> Mac users</a></li>
<li class="chapter" data-level="1.1.3" data-path="install-r.html"><a href="install-r.html#linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Linux users</a></li>
<li class="chapter" data-level="1.1.4" data-path="install-r.html"><a href="install-r.html#testing-r"><i class="fa fa-check"></i><b>1.1.4</b> Testing R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="installing-rstudio.html"><a href="installing-rstudio.html#windows-and-mac-users"><i class="fa fa-check"></i><b>1.2.1</b> Windows and Mac users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html#linux-users-1"><i class="fa fa-check"></i><b>1.2.2</b> Linux users</a></li>
<li class="chapter" data-level="1.2.3" data-path="installing-rstudio.html"><a href="installing-rstudio.html#testing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Testing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html"><i class="fa fa-check"></i><b>1.3</b> RStudio orientation</a><ul>
<li class="chapter" data-level="1.3.1" data-path="rstudio-orient.html"><a href="rstudio-orient.html#console"><i class="fa fa-check"></i><b>1.3.1</b> Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="rstudio-orient.html"><a href="rstudio-orient.html#environment-history-files"><i class="fa fa-check"></i><b>1.3.2</b> Environment / History / Files</a></li>
<li class="chapter" data-level="1.3.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html#plots-help-viewer"><i class="fa fa-check"></i><b>1.3.3</b> Plots / Help / Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html"><i class="fa fa-check"></i><b>1.4</b> Alternatives to RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>1.5</b> R packages</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-packages.html"><a href="r-packages.html#cran_packages"><i class="fa fa-check"></i><b>1.5.1</b> CRAN packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-packages.html"><a href="r-packages.html#bioconductor-packages"><i class="fa fa-check"></i><b>1.5.2</b> Bioconductor packages</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-packages.html"><a href="r-packages.html#github-packages"><i class="fa fa-check"></i><b>1.5.3</b> GitHub packages</a></li>
<li class="chapter" data-level="1.5.4" data-path="r-packages.html"><a href="r-packages.html#using-packages"><i class="fa fa-check"></i><b>1.5.4</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="writing-r-code.html"><a href="writing-r-code.html"><i class="fa fa-check"></i><b>1.6</b> Writing R code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-r.html"><a href="basics-r.html"><i class="fa fa-check"></i><b>2</b> Some R Basics</a></li>
<li class="chapter" data-level="3" data-path="data-r.html"><a href="data-r.html"><i class="fa fa-check"></i><b>3</b> Data in R</a></li>
<li class="chapter" data-level="4" data-path="graphics-r.html"><a href="graphics-r.html"><i class="fa fa-check"></i><b>4</b> Graphics in R</a><ul>
<li class="chapter" data-level="4.1" data-path="beginning-at-the-end.html"><a href="beginning-at-the-end.html"><i class="fa fa-check"></i><b>4.1</b> Beginning at the end</a></li>
<li class="chapter" data-level="4.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html"><i class="fa fa-check"></i><b>4.2</b> The start of the end</a><ul>
<li class="chapter" data-level="4.2.1" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#the-purest-of-ggplots"><i class="fa fa-check"></i><b>4.2.1</b> The purest of ggplots</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#wrapping-grids"><i class="fa fa-check"></i><b>4.2.2</b> Wrapping grids</a></li>
<li class="chapter" data-level="4.2.3" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#plotting-multiple-ggplots"><i class="fa fa-check"></i><b>4.2.3</b> Plotting multiple ggplots</a></li>
<li class="chapter" data-level="4.2.4" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#make-it-your-own"><i class="fa fa-check"></i><b>4.2.4</b> Make it your own</a></li>
<li class="chapter" data-level="4.2.5" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#setting-the-theme"><i class="fa fa-check"></i><b>4.2.5</b> Setting the theme</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats-r.html"><a href="stats-r.html"><i class="fa fa-check"></i><b>5</b> Simple Statistics in R</a></li>
<li class="chapter" data-level="6" data-path="prog-r.html"><a href="prog-r.html"><i class="fa fa-check"></i><b>6</b> Programming in R</a></li>
<li class="chapter" data-level="7" data-path="rmarkdown-r.html"><a href="rmarkdown-r.html"><i class="fa fa-check"></i><b>7</b> Reproducible reports</a></li>
<li class="chapter" data-level="8" data-path="github-r.html"><a href="github-r.html"><i class="fa fa-check"></i><b>8</b> Version control with Git and GitHub</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-start-of-the-end" class="section level2">
<h2><span class="header-section-number">4.2</span> The start of the end</h2>
<p>The first step in producing a <code>ggplot</code> is the easiest! We just need to install and then load the package. Use the skills you learnt in Chapter 1.5 to install and load the package. Note that although I (and pretty much everyone) refer to the package as <code>ggplot</code>, it’s proper name is <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>With that taken care of, let’s make our first <code>ggplot</code>!</p>
<div id="the-purest-of-ggplots" class="section level3">
<h3><span class="header-section-number">4.2.1</span> The purest of ggplots</h3>
<p>During the R course this book is based on, the students are asked at one point to shout out all of the functions they have either learnt in the course or heard of/used before. At this point in the course we have not touched on <code>ggplot</code>, but one year a student shouted out <code>ggplot()</code>. When asked what the <code>ggplot()</code> function does, they said that it makes a <code>ggplot</code>. This makes complete and utter sense. So let’s make a <code>ggplot</code> now:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">ggplot</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/pure%20ggplot-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>And here we have it. A fully formed, perfect <code>ggplot</code>. We may have a small issue though. Some puritan data visualisers/plotists/figurines make the claim that figures should include some form of information beyond a light grey background. As loathe as I am to agree with purists, I will do so here. We really should include some data. To do so, we need some data.</p>
<p>We’ll keep using the flower dataset that you used in the earlier chapters. Let’s have a quick reminder of what the data looked like.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">str</span>(flower)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">#&gt; &#39;data.frame&#39;:    96 obs. of  8 variables:</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">#&gt;  $ treat    : Factor w/ 2 levels &quot;notip&quot;,&quot;tip&quot;: 2 2 2 2 2 2 2 2 2 2 ...</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co">#&gt;  $ nitrogen : Factor w/ 3 levels &quot;high&quot;,&quot;low&quot;,&quot;medium&quot;: 3 3 3 3 3 3 3 3 3 3 ...</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co">#&gt;  $ block    : int  1 1 1 1 1 1 1 1 2 2 ...</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="co">#&gt;  $ height   : num  7.5 10.7 11.2 10.4 10.4 9.8 6.9 9.4 10.4 12.3 ...</span></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#&gt;  $ weight   : num  7.62 12.14 12.76 8.78 13.58 ...</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="co">#&gt;  $ leafarea : num  11.7 14.1 7.1 11.9 14.5 12.2 13.2 14 10.5 16.1 ...</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">#&gt;  $ shootarea: num  31.9 46 66.7 20.3 26.9 72.7 43.1 28.5 57.8 36.9 ...</span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="co">#&gt;  $ flowers  : int  1 10 10 1 4 9 7 6 5 8 ...</span></a></code></pre></div>
<p>We know from the “final figure” that we want shootarea on the y axis and weight on the x axis. To do so in <code>ggplot</code> we need to make use of the <code>aes()</code> function and also fulfill the <code>data =</code> argument. <code>aes</code> is short of aesthetics, and it’s the function we use to specify what we want displayed in the figure. Let’s try it now:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># Including aesthetics for x and y axess as well as speficying the dataset</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) </a></code></pre></div>
<p><img src="Rbook_files/figure-html/ggplot%20with%20xy%20axis-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s already much better. At least it’s no longer a blank grey canvas. We’ve now told <code>ggplot</code> what we want as our x and y axes as well as where to find that data. But what’s missing here is where we tell <code>ggplot</code> <em>how</em> to display that data. This is now the time to introduce you to “geoms” or geometric objects. Geoms are the way that <code>ggplot</code> displays information. For instance <code>geom_point()</code> tells <code>ggplot</code> that you want the information to be displayed as points (making scatterplot possible). Given that the “final figure” uses points, this is clearly the appropriate geom to use here.</p>
<p>Before we can do that, we need to talk about the coding structure used by <code>ggplot</code>. The analogy that I and many others use is to say that making a figure in <code>ggplot</code> is much like painting. What we’ve done in the above code is making our “canvas”. Now we are going to add sequential layers to that painting, increasing the complexity and detail over time. Each time we want to include a new layer we need to include a <code>+</code> at the end of the proceeding layer to tell R and <code>ggplot</code> that there are additional layers coming. Let’s add (<code>+</code>) a new geom now:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="st">    </span><span class="co"># Adding a geom to display data</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>()    </a></code></pre></div>
<p><img src="Rbook_files/figure-html/ggplot%20with%20geom_point-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If what we wanted was a quick and dirty figure to get a grasp of the trend in the data we can stop here. We can see that shootarea looks like it’s increasing with weight in a linear fashion. So long as this answers a question, we have a figure is perfectly suited for personal use. Though for showing to other people we might want something a bit more developed. If we glance back to our “final figure” we can see that we have lines representing different nitrogen concentrations. We can include lines using a geom. If you have a quick look through the available geoms <em>here</em>, you might think that <code>geom_line()</code> would be appropriate. Let’s try it.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">    </span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="st">    </span><span class="co"># Adding geom_line</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="st">    </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_line-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Not quite what we were going for. The problem that we have is that <code>geom_line()</code> is actually just playing join-the-dots. The geom we actually want to use is called <code>geom_smooth()</code>. We can fix that very easily just by changing “line” to “smooth”.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">    </span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="st">    </span><span class="co"># Changing to geom_smooth</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="st">    </span><span class="kw">geom_smooth</span>()</a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_smooth-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Better, but still not what we wanted. The challenge here is that drawing a line is actually somewhat complicated. The way this line was drawn was using a method called “LOESS” which gives something very close to a moving average; useful in some cases, less so in others [<code>ggplot</code> will use LOESS as default when you have &lt; 1000 observations]. Instead of a wiggly line, we want a nice simple straight line to be drawn using a method called “lm” or (linear model - see Chapter XXX for more details). Try looking at the help file, using <code>?geom_smooth</code>, to see what other options are available for the <code>method =</code> argument. While we’re at it, let’s get rid of the confidence interval ribbon around the line. I prefer to do this as I think it’s clearer to the audience that this isn’t a properly analysed line and to treat it as a visual aid only. We can do this at the same time using the <code>se =</code> argument.</p>
<p>Let’s update the code to use a linear model without confidence intervals.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">    </span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">    </span><span class="co"># Specifying the method as lm and se to false</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_smooth%20lm-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s exactly what we wanted, though it’s still not matching the “final figure”. We need <code>geom_smooth()</code> to draw lines for each level of nitrogen concentration. Getting <code>ggplot</code> to do that is pretty straightforward. We can use the <code>colour =</code> within <code>aes()</code> to use tell <code>ggplot</code> to draw a different coloured line depending on nitrogen concentration.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">    </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">    </span><span class="co"># Including colour argument in aes()</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_smooth%20colour%20lm-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We’re getting closer, but this is actually a good time to talk about where to include information - whether to include it in a geom or in <code>ggplot()</code>. When we include information such as <code>data =</code> and <code>aes()</code> in <code>ggplot()</code> we are setting those as the default, universal values which all subsequent geoms use. We can easily move the information around and get exactly the same figure.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">    </span><span class="co"># Moved aes() and data into geoms</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/universal%20vrs%20geom-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Doing so we get exactly the same figure. This ability to move information around is surprisingly powerful. It can allow different geoms to display different (albeit similar) information (see more on this later).</p>
<p>For this worked example, we’ll move the information back to the universal <code>ggplot()</code> so that we can have the points coloured as well.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># Moved colour = nitrogen into the universal ggplot()</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/universal%20colours-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This figure is now what I would consider to be the typical <code>ggplot</code> figure. We have specified some information, and with only a few lines of code, yet we have something that looks quite attractive. While it’s not yet the “final figure” it is perfectly fit for purpose. You have now created you’re first “pure” <code>ggplot</code>.</p>
<p>Once you’ve seen this figure you will see version similar to it more and more often. But we’re aiming for something a bit more developed.</p>
</div>
<div id="wrapping-grids" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Wrapping grids</h3>
<p>Having made our “pure” <code>ggplot</code>, the next big obstacle we’re going to tackle is the grid like layout of the “final figure”. <code>ggplot</code> includes options for determining the “facets” of a figure. We’ll start off by using <code>facet_wrap()</code> to show what this can do. For <code>facet_wrap()</code> to work we need to specify a formula for how the facets will be defined (see <code>?facet_wrap</code> for more details and also for how to define facets without using a formula).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">    </span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">    </span><span class="co"># Including a facet</span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_wrap-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s pretty good, though we are missing the rows showing different blocks. Given that facet_wrap can use a formula, maybe we could simply include block in the formula? Remember that block refers to the region in the greenhouse where the plants were grown (it’s not something special to <code>ggplot</code> in this case). Let’s try it and see what happens.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="st">    </span></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="st">    </span><span class="co"># Adding &quot;block&quot; to formula</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>block)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_wrap%20formula-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><em>Side quest</em>: Try messing around with the formula to see what happens. Try putting <code>~ treat + flowers</code> or even <code>~ treat + block + flowers</code>. The important thing to remember here is that facet_wrap will create a new figure for each value in a variable. So when you wrap using a continuous variable like flowers, it makes a plot for every number of flowers counted. Be aware of what it is you are doing, but never be scared to experiment. Mistakes are easily fixed in R - it’s not like a point and click figure maker where you’d have to go through all those clicks to get the same figure again. Made a mistake? Easy, change it back and rerun the code (see Chapter XXX for version control which takes this to the next level).</p>
<p>This figure is almost exactly what we want. <em>Almost</em>. But not exactly. In this case we actually want to be using <code>facet_grid()</code>, an alternative to <code>facet_wrap()</code> which should put us back on track to make the “final figure”.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="st">    </span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="st">    </span><span class="co"># Changing to facet_grid</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="st">    </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>block)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_grid-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s disappointing. It’s pretty much the same as we had before and is no closer to the “final figure”. What we need to do to fix it is to rearrange our formula so that we say that block in relation to treatment (not in combination to).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="st">    </span></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="st">    </span><span class="co"># Rearranging formula</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_grid%20formula-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="plotting-multiple-ggplots" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Plotting multiple ggplots</h3>
<p>And we’re there. Although the styling is not the same as the “final figure” this is showing the exact same information. We can plot them side-by-side to see how they compare. To do so we will use an additional package called <code>patchwork</code>. Go ahead and install and load patchwork (see Chapter 1.5 if you need a refresher for how to do this).</p>
<p>We’ll need to go back to our previous code and do something clever. We can assign figures a name and then use that to call the figure whenever we run the name. For instance, I have assigned the “final figure” the name…. <code>final_figure</code> (I’m not a clever person).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">final_figure</a></code></pre></div>
<p><img src="Rbook_files/figure-html/calling%20figure%20name-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We’ll do the same with the figure we’ve created together:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># Naming our figure object</span></a>
<a class="sourceLine" id="cb34-2" title="2">rbook_figure &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p>Now when the code is run, the figure won’t be presented. This will only happen when we run the name of the figure as code. We can do this while also showing <code>patchwork</code>.
An old headache when using <code>ggplot</code> was that it could be difficult to create a nested figure (different plots all part of the same figure). Patchwork resolves this problem very elegantly and simply. We have two immediate and simple options with patchwork; figures on top of each other (operationalised with <code>/</code>) and figures side-by-side (operationalised with either <code>+</code> or <code>|</code>). Let’s try.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># rbook_figure | final_figure</span></a></code></pre></div>
<p>Giving us a nested side-by-side figure.</p>
<p><em>Side quest</em>: Try to create a stacked version of the above figure.</p>
<p>We can also assign nested <code>patchwork</code> figures a name and use this in turn to create labels for individuals figures.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># nested_compare &lt;- rbook_figure + final_figure</span></a>
<a class="sourceLine" id="cb36-2" title="2"></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co">#nested_compare + </span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co">#   plot_annotation(tag_levels = &quot;A&quot;)</span></a></code></pre></div>
</div>
<div id="make-it-your-own" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Make it your own</h3>
<p>While we have a great figure already that shows the data we want it to show, it uses all of the default stylistic options. While the default options are arguably good, they may not be what we want ourselves. Maybe we’re going to use this figure in a presentation and we want to make sure someone in the very back of the room can easily read the figure. Maybe we want to use our own colour scheme. Maybe we want to change the grey background to a nice bright neon pink. In essence, maybe we want to decide things for ourselves. This next section will go through how to customise the appearance of our figure.</p>
<p>Let’s start with the easier stuff, namely changing the size of the points using the <code>size =</code> argument. Before we do, have a think about where we’d include the argument? Should it be in <code>ggplot()</code> or <code>geom_point()</code>?</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">    </span><span class="co"># Including size argument to change the size of the points</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-7" title="7"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/change%20size-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Straightforward, we changed the size from the default of <code>size = 1</code> to a value that we decide for ourselves. What happens if you included size in <code>ggplot</code>?</p>
<p>If we wanted to change the shape of the points to reflect nitrogen concentrations, how do you think we’d do that? We’d use the <code>shape =</code> argument, but this time we need to include an <code>aes()</code> within <code>geom_point()</code> because we want to include specific data to be displayed on the figure.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="st">    </span><span class="co"># Including shape argument to change the shape of the points</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb38-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-7" title="7"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/change%20shape-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Try including <code>shape = nitrogen</code> without also including <code>aes()</code> and see what happens.</p>
<p>We’re getting closer and closer to the “final figure”. Another thing we may want to be able to do is change the transparency of the points. While it’s not actually that crucial here, changing the transparency of points is really valuable when you have lots of data and big clusters of points can be hidden. Doing this is, again, surprisingly easy, accomplished using the <code>alpha =</code> argument. Again, ask yourself where you think the <code>alpha =</code> argument should be included.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="st">    </span><span class="co"># Including alpha argument to change the transparency of the points</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/change%20alpha-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can also include defined labels for the x and y axis. There are a couple of ways to do this, but my preferred way is the same as used in base R figures; using <code>xlab()</code> and <code>ylab()</code>. As we are going to be creating new layers and adding them onto the figure, we’ll need to convey this to <code>ggplot</code> using <code>+</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="st">    </span><span class="co"># Adding layers for x and y labels</span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-8" title="8"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Area of shoot (cm^2)&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/axis%20labels-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Great. Just as we wanted, though getting the “(cm^2)” to show the square as a superscript would be ideal. Here, we’re going to use a function which is part of base R called <code>bquote()</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="st">    </span></a>
<a class="sourceLine" id="cb41-7" title="7"><span class="st">    </span><span class="co"># Using bquote to get mathematically correct formatting</span></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<p><img src="Rbook_files/figure-html/bquote-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="setting-the-theme" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Setting the theme</h3>
<p><code>ggplot</code> contains so called themes. Themes control the base style of a ggplot. Let’s play around with themes using some skills we’ve already learnt; assigning plots to objects and plotting multiple <code>ggplots</code> in a single figure to explore some theme options. We assign themes by creating a new layer with <code>theme_X()</code>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">classic &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-7" title="7"></a>
<a class="sourceLine" id="cb42-8" title="8"><span class="st">    </span></a>
<a class="sourceLine" id="cb42-9" title="9"><span class="st">    </span><span class="co"># Classic theme</span></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="st">    </span><span class="kw">theme_classic</span>()</a>
<a class="sourceLine" id="cb42-11" title="11"></a>
<a class="sourceLine" id="cb42-12" title="12">bw &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-13" title="13"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-15" title="15"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-16" title="16"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-17" title="17"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-18" title="18"><span class="st">    </span></a>
<a class="sourceLine" id="cb42-19" title="19"><span class="st">    </span><span class="co"># Black and white theme</span></a>
<a class="sourceLine" id="cb42-20" title="20"><span class="st">    </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb42-21" title="21"></a>
<a class="sourceLine" id="cb42-22" title="22">minimal &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-23" title="23"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-24" title="24"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-25" title="25"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-26" title="26"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-27" title="27"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-28" title="28"><span class="st">    </span></a>
<a class="sourceLine" id="cb42-29" title="29"><span class="st">    </span><span class="co"># Minimal theme</span></a>
<a class="sourceLine" id="cb42-30" title="30"><span class="st">    </span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb42-31" title="31"></a>
<a class="sourceLine" id="cb42-32" title="32">light &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-33" title="33"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-34" title="34"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-35" title="35"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-36" title="36"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-37" title="37"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-38" title="38"><span class="st">    </span></a>
<a class="sourceLine" id="cb42-39" title="39"><span class="st">    </span><span class="co"># Light theme</span></a>
<a class="sourceLine" id="cb42-40" title="40"><span class="st">    </span><span class="kw">theme_light</span>()</a>
<a class="sourceLine" id="cb42-41" title="41"></a>
<a class="sourceLine" id="cb42-42" title="42"><span class="co">#(classic | bw) /</span></a>
<a class="sourceLine" id="cb42-43" title="43"><span class="co">#   (minimal | light)</span></a></code></pre></div>
<p>In terms of finding a theme that most closely matches our “final figure”, it’s probably going to be <code>theme_classic()</code>. There are additional themes available to you, and even more available online. <code>GGthemes</code> is a package you can download to get even more theme options. The BBC even have their own <code>ggplot</code> theme called “BBplot” (though I personally don’t like it too much for scientific figures). Indeed, you can even make your own theme which is what we’ll work on next. To begin with, we’ll have a look to see how <code>theme_classic()</code> was coded. We can do that easily enough by just writing the function name without the paranethesis (brackets).</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">theme_classic</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co">#&gt; function (base_size = 11, base_family = &quot;&quot;, base_line_size = base_size/22, </span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co">#&gt;     base_rect_size = base_size/22) </span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="co">#&gt;     theme_bw(base_size = base_size, base_family = base_family, </span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co">#&gt;         base_line_size = base_line_size, base_rect_size = base_rect_size) %+replace% </span></a>
<a class="sourceLine" id="cb43-7" title="7"><span class="co">#&gt;         theme(panel.border = element_blank(), panel.grid.major = element_blank(), </span></a>
<a class="sourceLine" id="cb43-8" title="8"><span class="co">#&gt;             panel.grid.minor = element_blank(), axis.line = element_line(colour = &quot;black&quot;, </span></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="co">#&gt;                 size = rel(1)), legend.key = element_blank(), </span></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="co">#&gt;             strip.background = element_rect(fill = &quot;white&quot;, colour = &quot;black&quot;, </span></a>
<a class="sourceLine" id="cb43-11" title="11"><span class="co">#&gt;                 size = rel(2)), complete = TRUE)</span></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb43-13" title="13"><span class="co">#&gt; &lt;bytecode: 0x000000001931e8c0&gt;</span></a>
<a class="sourceLine" id="cb43-14" title="14"><span class="co">#&gt; &lt;environment: namespace:ggplot2&gt;</span></a></code></pre></div>
<p>Let’s use this code as the basis for our own theme and modify it according to our needs. We’ll call the theme, <code>theme_rbook</code>. Not all of the options will immediately make sense, but don’t worry about this too much for now. Just know that the settings we’re putting in place are:
- Font size for axis titles = 20
- Font size for x axis text = 10
- Font size for y axis text = 10
- Font for caption = 10 and italics
- Background colour = white
- Background border = black
- Axis lines = black
- Strip colour (for facets) = black
- Strip text colour (for facets) = white
- Legend box colours = blank</p>
<p>This is by no means an exhaustive list of features you can specify in your own theme, but this will get you started. Of course, there is no need to use a personalised theme as the pre-built options are perfectly suitable.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">theme_rbook &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">base_size =</span> <span class="dv">20</span>, <span class="dt">base_family =</span> <span class="st">&quot;&quot;</span>, <span class="dt">base_line_size =</span> base_size<span class="op">/</span><span class="dv">22</span>, <span class="dt">base_rect_size =</span> base_size<span class="op">/</span><span class="dv">22</span>) {         </a>
<a class="sourceLine" id="cb44-2" title="2">  <span class="kw">theme</span>( </a>
<a class="sourceLine" id="cb44-3" title="3">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),                               </a>
<a class="sourceLine" id="cb44-4" title="4">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),                              </a>
<a class="sourceLine" id="cb44-5" title="5">    <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),                              </a>
<a class="sourceLine" id="cb44-6" title="6">    <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>),            </a>
<a class="sourceLine" id="cb44-7" title="7">    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>),                      </a>
<a class="sourceLine" id="cb44-8" title="8">    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb44-9" title="9">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb44-10" title="10">    <span class="dt">strip.background =</span><span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb44-11" title="11">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>),</a>
<a class="sourceLine" id="cb44-12" title="12">        <span class="dt">legend.key=</span><span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb44-13" title="13">  )</a>
<a class="sourceLine" id="cb44-14" title="14">}</a></code></pre></div>
<p><code>theme_rbook()</code> is now available for us to use just like any other theme. Let’s try remaking our figure using our new theme.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="st">    </span></a>
<a class="sourceLine" id="cb45-8" title="8"><span class="st">    </span><span class="co"># Updated theme to our theme_rbook</span></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/rbook%20figure-1.png" width="75%" style="display: block; margin: auto;" /></p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="beginning-at-the-end.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stats-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexd106/Rbook/edit/master/04-graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
