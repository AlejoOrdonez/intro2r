<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 The start of the end | A Introduction to R</title>
  <meta name="description" content="An Introduction to R" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 The start of the end | A Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to R" />
  <meta name="github-repo" content="alexd106/Rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 The start of the end | A Introduction to R" />
  
  <meta name="twitter:description" content="An Introduction to R" />
  

<meta name="author" content="Alex Douglas, Francesca Mancini, Deon Roos, Ana Couto &amp; David Lusseau" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="beginning-at-the-end.html"/>
<link rel="next" href="tips-and-tricks.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="the-aim-of-this-book.html"><a href="the-aim-of-this-book.html"><i class="fa fa-check"></i><b>0.1</b> The aim of this book</a></li>
<li class="chapter" data-level="0.2" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i><b>0.2</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.3" data-path="why-an-open-book.html"><a href="why-an-open-book.html"><i class="fa fa-check"></i><b>0.3</b> Why an open book?</a></li>
<li class="chapter" data-level="0.4" data-path="who-are-we.html"><a href="who-are-we.html"><i class="fa fa-check"></i><b>0.4</b> Who are we?</a></li>
<li class="chapter" data-level="0.5" data-path="book-website.html"><a href="book-website.html"><i class="fa fa-check"></i><b>0.5</b> Book website</a></li>
<li class="chapter" data-level="0.6" data-path="some-r-pointers.html"><a href="some-r-pointers.html"><i class="fa fa-check"></i><b>0.6</b> Some R pointers</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="install-r.html"><a href="install-r.html"><i class="fa fa-check"></i><b>1.1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="install-r.html"><a href="install-r.html#windows-users"><i class="fa fa-check"></i><b>1.1.1</b> Windows users</a></li>
<li class="chapter" data-level="1.1.2" data-path="install-r.html"><a href="install-r.html#mac-users"><i class="fa fa-check"></i><b>1.1.2</b> Mac users</a></li>
<li class="chapter" data-level="1.1.3" data-path="install-r.html"><a href="install-r.html#linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Linux users</a></li>
<li class="chapter" data-level="1.1.4" data-path="install-r.html"><a href="install-r.html#testing-r"><i class="fa fa-check"></i><b>1.1.4</b> Testing R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="installing-rstudio.html"><a href="installing-rstudio.html#windows-and-mac-users"><i class="fa fa-check"></i><b>1.2.1</b> Windows and Mac users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html#linux-users-1"><i class="fa fa-check"></i><b>1.2.2</b> Linux users</a></li>
<li class="chapter" data-level="1.2.3" data-path="installing-rstudio.html"><a href="installing-rstudio.html#testing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Testing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html"><i class="fa fa-check"></i><b>1.3</b> RStudio orientation</a><ul>
<li class="chapter" data-level="1.3.1" data-path="rstudio-orient.html"><a href="rstudio-orient.html#cons"><i class="fa fa-check"></i><b>1.3.1</b> Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="rstudio-orient.html"><a href="rstudio-orient.html#environment-history-connections"><i class="fa fa-check"></i><b>1.3.2</b> Environment / History / Connections</a></li>
<li class="chapter" data-level="1.3.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html#files-plots-packages-help-viewer"><i class="fa fa-check"></i><b>1.3.3</b> Files / Plots / Packages / Help / Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html"><i class="fa fa-check"></i><b>1.4</b> Alternatives to RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.5</b> R packages</a><ul>
<li class="chapter" data-level="1.5.1" data-path="packages.html"><a href="packages.html#cran_packages"><i class="fa fa-check"></i><b>1.5.1</b> CRAN packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="packages.html"><a href="packages.html#bioconductor-packages"><i class="fa fa-check"></i><b>1.5.2</b> Bioconductor packages</a></li>
<li class="chapter" data-level="1.5.3" data-path="packages.html"><a href="packages.html#github-packages"><i class="fa fa-check"></i><b>1.5.3</b> GitHub packages</a></li>
<li class="chapter" data-level="1.5.4" data-path="packages.html"><a href="packages.html#using-packages"><i class="fa fa-check"></i><b>1.5.4</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="rsprojs.html"><a href="rsprojs.html"><i class="fa fa-check"></i><b>1.6</b> Projects in RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="working-directories.html"><a href="working-directories.html"><i class="fa fa-check"></i><b>1.7</b> Working directories</a></li>
<li class="chapter" data-level="1.8" data-path="directory-structure.html"><a href="directory-structure.html"><i class="fa fa-check"></i><b>1.8</b> Directory structure</a></li>
<li class="chapter" data-level="1.9" data-path="file-names.html"><a href="file-names.html"><i class="fa fa-check"></i><b>1.9</b> File names</a></li>
<li class="chapter" data-level="1.10" data-path="project-documentation.html"><a href="project-documentation.html"><i class="fa fa-check"></i><b>1.10</b> Project documentation</a></li>
<li class="chapter" data-level="1.11" data-path="r-style-guide.html"><a href="r-style-guide.html"><i class="fa fa-check"></i><b>1.11</b> R style guide</a></li>
<li class="chapter" data-level="1.12" data-path="backing-up-projects.html"><a href="backing-up-projects.html"><i class="fa fa-check"></i><b>1.12</b> Backing up projects</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-r.html"><a href="basics-r.html"><i class="fa fa-check"></i><b>2</b> Some R basics</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="objects-in-r.html"><a href="objects-in-r.html"><i class="fa fa-check"></i><b>2.2</b> Objects in R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="objects-in-r.html"><a href="objects-in-r.html#creating-objects"><i class="fa fa-check"></i><b>2.2.1</b> Creating objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="objects-in-r.html"><a href="objects-in-r.html#naming-objects"><i class="fa fa-check"></i><b>2.2.2</b> Naming objects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-functions.html"><a href="r-functions.html"><i class="fa fa-check"></i><b>2.3</b> R functions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="r-functions.html"><a href="r-functions.html#using-functions"><i class="fa fa-check"></i><b>2.3.1</b> Using functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="working-with-vectors.html"><a href="working-with-vectors.html"><i class="fa fa-check"></i><b>2.4</b> Working with vectors</a><ul>
<li class="chapter" data-level="2.4.1" data-path="working-with-vectors.html"><a href="working-with-vectors.html#extracting-elements"><i class="fa fa-check"></i><b>2.4.1</b> Extracting elements</a></li>
<li class="chapter" data-level="2.4.2" data-path="working-with-vectors.html"><a href="working-with-vectors.html#replacing-elements"><i class="fa fa-check"></i><b>2.4.2</b> Replacing elements</a></li>
<li class="chapter" data-level="2.4.3" data-path="working-with-vectors.html"><a href="working-with-vectors.html#ordering-elements"><i class="fa fa-check"></i><b>2.4.3</b> Ordering elements</a></li>
<li class="chapter" data-level="2.4.4" data-path="working-with-vectors.html"><a href="working-with-vectors.html#missing-data"><i class="fa fa-check"></i><b>2.4.4</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>2.5</b> Getting help</a><ul>
<li class="chapter" data-level="2.5.1" data-path="help.html"><a href="help.html#r-help"><i class="fa fa-check"></i><b>2.5.1</b> R help</a></li>
<li class="chapter" data-level="2.5.2" data-path="help.html"><a href="help.html#other-sources-of-help"><i class="fa fa-check"></i><b>2.5.2</b> Other sources of help</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="saving-stuff-in-r.html"><a href="saving-stuff-in-r.html"><i class="fa fa-check"></i><b>2.6</b> Saving stuff in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-r.html"><a href="data-r.html"><i class="fa fa-check"></i><b>3</b> Data in R</a></li>
<li class="chapter" data-level="4" data-path="graphics-r.html"><a href="graphics-r.html"><i class="fa fa-check"></i><b>4</b> Graphics in R</a><ul>
<li class="chapter" data-level="4.1" data-path="beginning-at-the-end.html"><a href="beginning-at-the-end.html"><i class="fa fa-check"></i><b>4.1</b> Beginning at the end</a></li>
<li class="chapter" data-level="4.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html"><i class="fa fa-check"></i><b>4.2</b> The start of the end</a><ul>
<li class="chapter" data-level="4.2.1" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#the-purest-of-ggplots"><i class="fa fa-check"></i><b>4.2.1</b> The purest of ggplots</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#wrapping-grids"><i class="fa fa-check"></i><b>4.2.2</b> Wrapping grids</a></li>
<li class="chapter" data-level="4.2.3" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#plotting-multiple-ggplots"><i class="fa fa-check"></i><b>4.2.3</b> Plotting multiple ggplots</a></li>
<li class="chapter" data-level="4.2.4" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#make-it-your-own"><i class="fa fa-check"></i><b>4.2.4</b> Make it your own</a></li>
<li class="chapter" data-level="4.2.5" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#setting-the-theme"><i class="fa fa-check"></i><b>4.2.5</b> Setting the theme</a></li>
<li class="chapter" data-level="4.2.6" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#prettification"><i class="fa fa-check"></i><b>4.2.6</b> Prettification</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html"><i class="fa fa-check"></i><b>4.3</b> Tips and tricks</a><ul>
<li class="chapter" data-level="4.3.1" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#statistics-layer"><i class="fa fa-check"></i><b>4.3.1</b> Statistics layer</a></li>
<li class="chapter" data-level="4.3.2" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#axis-limits-and-zooms"><i class="fa fa-check"></i><b>4.3.2</b> Axis limits and zooms</a></li>
<li class="chapter" data-level="4.3.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#layering-layers"><i class="fa fa-check"></i><b>4.3.3</b> Layering layers</a></li>
<li class="chapter" data-level="4.3.4" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#continuous-colours"><i class="fa fa-check"></i><b>4.3.4</b> Continuous colours</a></li>
<li class="chapter" data-level="4.3.5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#size-of-points"><i class="fa fa-check"></i><b>4.3.5</b> Size of points</a></li>
<li class="chapter" data-level="4.3.6" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#moving-the-legend"><i class="fa fa-check"></i><b>4.3.6</b> Moving the legend</a></li>
<li class="chapter" data-level="4.3.7" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#hiding-the-legend"><i class="fa fa-check"></i><b>4.3.7</b> Hiding the legend</a></li>
<li class="chapter" data-level="4.3.8" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#hiding-part-of-the-legend"><i class="fa fa-check"></i><b>4.3.8</b> Hiding part of the legend</a></li>
<li class="chapter" data-level="4.3.9" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#writing-on-a-figure"><i class="fa fa-check"></i><b>4.3.9</b> Writing on a figure</a></li>
<li class="chapter" data-level="4.3.10" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#ticks-and-tick-labels"><i class="fa fa-check"></i><b>4.3.10</b> Ticks and tick labels</a></li>
<li class="chapter" data-level="4.3.11" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#more-advanced-patchwork"><i class="fa fa-check"></i><b>4.3.11</b> More advanced patchwork</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html"><i class="fa fa-check"></i><b>4.4</b> A ggplot bestiary</a><ul>
<li class="chapter" data-level="4.4.1" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#density-plot"><i class="fa fa-check"></i><b>4.4.1</b> Density plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#histogram"><i class="fa fa-check"></i><b>4.4.2</b> Histogram</a></li>
<li class="chapter" data-level="4.4.3" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#frequency-polygons"><i class="fa fa-check"></i><b>4.4.3</b> Frequency polygons</a></li>
<li class="chapter" data-level="4.4.4" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#boxplot"><i class="fa fa-check"></i><b>4.4.4</b> Boxplot</a></li>
<li class="chapter" data-level="4.4.5" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#violin-plots"><i class="fa fa-check"></i><b>4.4.5</b> Violin plots</a></li>
<li class="chapter" data-level="4.4.6" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#barchart"><i class="fa fa-check"></i><b>4.4.6</b> Barchart</a></li>
<li class="chapter" data-level="4.4.7" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#quantile-lines"><i class="fa fa-check"></i><b>4.4.7</b> Quantile lines</a></li>
<li class="chapter" data-level="4.4.8" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#heatmap"><i class="fa fa-check"></i><b>4.4.8</b> Heatmap</a></li>
<li class="chapter" data-level="4.4.9" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#hex-map"><i class="fa fa-check"></i><b>4.4.9</b> Hex map</a></li>
<li class="chapter" data-level="4.4.10" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#contour-map"><i class="fa fa-check"></i><b>4.4.10</b> Contour map</a></li>
<li class="chapter" data-level="4.4.11" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#cleveland-dotplot"><i class="fa fa-check"></i><b>4.4.11</b> Cleveland dotplot</a></li>
<li class="chapter" data-level="4.4.12" data-path="a-ggplot-bestiary.html"><a href="a-ggplot-bestiary.html#pairs-plot"><i class="fa fa-check"></i><b>4.4.12</b> Pairs plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats-r.html"><a href="stats-r.html"><i class="fa fa-check"></i><b>5</b> Simple Statistics in R</a></li>
<li class="chapter" data-level="6" data-path="prog-r.html"><a href="prog-r.html"><i class="fa fa-check"></i><b>6</b> Programming in R</a></li>
<li class="chapter" data-level="7" data-path="rmarkdown-r.html"><a href="rmarkdown-r.html"><i class="fa fa-check"></i><b>7</b> Reproducible reports with R markdown</a><ul>
<li class="chapter" data-level="7.1" data-path="what-is-r-markdown.html"><a href="what-is-r-markdown.html"><i class="fa fa-check"></i><b>7.1</b> What is R markdown?</a></li>
<li class="chapter" data-level="7.2" data-path="why-use-r-markdown.html"><a href="why-use-r-markdown.html"><i class="fa fa-check"></i><b>7.2</b> Why use R markdown?</a></li>
<li class="chapter" data-level="7.3" data-path="get-started-with-r-markdown.html"><a href="get-started-with-r-markdown.html"><i class="fa fa-check"></i><b>7.3</b> Get started with R markdown</a></li>
<li class="chapter" data-level="7.4" data-path="new-rm.html"><a href="new-rm.html"><i class="fa fa-check"></i><b>7.4</b> Create an R markdown document</a></li>
<li class="chapter" data-level="7.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html"><i class="fa fa-check"></i><b>7.5</b> R markdown anatomy</a><ul>
<li class="chapter" data-level="7.5.1" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#yaml-header"><i class="fa fa-check"></i><b>7.5.1</b> YAML header</a></li>
<li class="chapter" data-level="7.5.2" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#formatted-text"><i class="fa fa-check"></i><b>7.5.2</b> Formatted text</a></li>
<li class="chapter" data-level="7.5.3" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#code_chunks"><i class="fa fa-check"></i><b>7.5.3</b> Code chunks</a></li>
<li class="chapter" data-level="7.5.4" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-figures"><i class="fa fa-check"></i><b>7.5.4</b> Adding figures</a></li>
<li class="chapter" data-level="7.5.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-tables"><i class="fa fa-check"></i><b>7.5.5</b> Adding tables</a></li>
<li class="chapter" data-level="7.5.6" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#inline-r-code"><i class="fa fa-check"></i><b>7.5.6</b> Inline R code</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tips-tricks.html"><a href="tips-tricks.html"><i class="fa fa-check"></i><b>7.6</b> Some tips and tricks</a></li>
<li class="chapter" data-level="7.7" data-path="further-information.html"><a href="further-information.html"><i class="fa fa-check"></i><b>7.7</b> Further Information</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="github-r.html"><a href="github-r.html"><i class="fa fa-check"></i><b>8</b> Version control with Git and GitHub</a><ul>
<li class="chapter" data-level="8.1" data-path="what-is-version-control.html"><a href="what-is-version-control.html"><i class="fa fa-check"></i><b>8.1</b> What is version control?</a></li>
<li class="chapter" data-level="8.2" data-path="why-use-version-control.html"><a href="why-use-version-control.html"><i class="fa fa-check"></i><b>8.2</b> Why use version control?</a></li>
<li class="chapter" data-level="8.3" data-path="what-is-git-and-github.html"><a href="what-is-git-and-github.html"><i class="fa fa-check"></i><b>8.3</b> What is Git and GitHub?</a></li>
<li class="chapter" data-level="8.4" data-path="setup-git.html"><a href="setup-git.html"><i class="fa fa-check"></i><b>8.4</b> Getting started</a><ul>
<li class="chapter" data-level="8.4.1" data-path="setup-git.html"><a href="setup-git.html#install-git"><i class="fa fa-check"></i><b>8.4.1</b> Install Git</a></li>
<li class="chapter" data-level="8.4.2" data-path="setup-git.html"><a href="setup-git.html#configure-git"><i class="fa fa-check"></i><b>8.4.2</b> Configure Git</a></li>
<li class="chapter" data-level="8.4.3" data-path="setup-git.html"><a href="setup-git.html#rs_config"><i class="fa fa-check"></i><b>8.4.3</b> Configure RStudio</a></li>
<li class="chapter" data-level="8.4.4" data-path="setup-git.html"><a href="setup-git.html#register-a-github-account"><i class="fa fa-check"></i><b>8.4.4</b> Register a GitHub account</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html"><i class="fa fa-check"></i><b>8.5</b> Setting up a project in RStudio</a><ul>
<li class="chapter" data-level="8.5.1" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt1"><i class="fa fa-check"></i><b>8.5.1</b> Option 1 - GitHub first</a></li>
<li class="chapter" data-level="8.5.2" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt2"><i class="fa fa-check"></i><b>8.5.2</b> Option 2 - RStudio first</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="use-git.html"><a href="use-git.html"><i class="fa fa-check"></i><b>8.6</b> Using Git</a><ul>
<li class="chapter" data-level="8.6.1" data-path="use-git.html"><a href="use-git.html#tracking-changes"><i class="fa fa-check"></i><b>8.6.1</b> Tracking changes</a></li>
<li class="chapter" data-level="8.6.2" data-path="use-git.html"><a href="use-git.html#commit-history"><i class="fa fa-check"></i><b>8.6.2</b> Commit history</a></li>
<li class="chapter" data-level="8.6.3" data-path="use-git.html"><a href="use-git.html#undo"><i class="fa fa-check"></i><b>8.6.3</b> Reverting changes</a></li>
<li class="chapter" data-level="8.6.4" data-path="use-git.html"><a href="use-git.html#collab"><i class="fa fa-check"></i><b>8.6.4</b> Collaborate with Git</a></li>
<li class="chapter" data-level="8.6.5" data-path="use-git.html"><a href="use-git.html#git-tips"><i class="fa fa-check"></i><b>8.6.5</b> Git tips</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>8.7</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>9</b> Appendix</a><ul>
<li class="chapter" data-level="9.1" data-path="install-rm.html"><a href="install-rm.html"><i class="fa fa-check"></i><b>9.1</b> Installing R Markdown</a><ul>
<li class="chapter" data-level="9.1.1" data-path="install-rm.html"><a href="install-rm.html#ms-windows"><i class="fa fa-check"></i><b>9.1.1</b> MS Windows</a></li>
<li class="chapter" data-level="9.1.2" data-path="install-rm.html"><a href="install-rm.html#mac-osx"><i class="fa fa-check"></i><b>9.1.2</b> Mac OSX</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-start-of-the-end" class="section level2">
<h2><span class="header-section-number">4.2</span> The start of the end</h2>
<p>The first step in producing a <code>ggplot()</code> is the easiest! We just need to install and then load the package. Use the skills you learnt in Chapter 1.5 to install and load the package. Note that although most people refer to the package as <code>ggplot</code>, it’s proper name is <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>With that taken care of, let’s make our first <code>ggplot()</code>!</p>
<p><br />
</p>
<div id="the-purest-of-ggplots" class="section level3">
<h3><span class="header-section-number">4.2.1</span> The purest of ggplots</h3>
<p>During the R course that this book is based on, the students are asked at one point to name all of the functions they have either learnt during the course, have heard of previously, or have used before. At this point in the course, the students have not yet learnt about <code>ggplot2</code>, but never-the-less one year a student suggested the function <code>ggplot()</code>. When asked what the <code>ggplot()</code> function does, they joked that it obviously makes a <code>ggplot.</code> This makes intuitive sense, so let’s make a <code>ggplot</code> now:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">ggplot</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/pure%20ggplot-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>And here we have it. A fully formed, perfect <code>ggplot</code>. We may have a small issue though. Some puritan data visualisers/plotists/figurines make the claim that figures should include some form of information beyond a light grey background. As loathe as I am to agree with purists, I will do so here. We really should include some information, but to do so, we need data.</p>
<p>We’ll keep using the flower dataset that you’ve used in the earlier chapters. Let’s have a quick reminder of what the data looked like.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">str</span>(flower)</a>
<a class="sourceLine" id="cb82-2" title="2"><span class="co"># &#39;data.frame&#39;: 96 obs. of  8 variables:</span></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co">#  $ treat    : Factor w/ 2 levels &quot;notip&quot;,&quot;tip&quot;: 2 2 2 2 2 2 2 2 2 2 ...</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="co">#  $ nitrogen : Factor w/ 3 levels &quot;high&quot;,&quot;low&quot;,&quot;medium&quot;: 3 3 3 3 3 3 3 3 3 3 ...</span></a>
<a class="sourceLine" id="cb82-5" title="5"><span class="co">#  $ block    : int  1 1 1 1 1 1 1 1 2 2 ...</span></a>
<a class="sourceLine" id="cb82-6" title="6"><span class="co">#  $ height   : num  7.5 10.7 11.2 10.4 10.4 9.8 6.9 9.4 10.4 12.3 ...</span></a>
<a class="sourceLine" id="cb82-7" title="7"><span class="co">#  $ weight   : num  7.62 12.14 12.76 8.78 13.58 ...</span></a>
<a class="sourceLine" id="cb82-8" title="8"><span class="co">#  $ leafarea : num  11.7 14.1 7.1 11.9 14.5 12.2 13.2 14 10.5 16.1 ...</span></a>
<a class="sourceLine" id="cb82-9" title="9"><span class="co">#  $ shootarea: num  31.9 46 66.7 20.3 26.9 72.7 43.1 28.5 57.8 36.9 ...</span></a>
<a class="sourceLine" id="cb82-10" title="10"><span class="co">#  $ flowers  : int  1 10 10 1 4 9 7 6 5 8 ...</span></a></code></pre></div>
<p>We know from the “final figure” that we want shootarea on the y axis (response/dependent variable) and weight on the x axis (explanatory/independent variable). To do so in <code>ggplot2</code> we need to make use of the <code>aes()</code> function and also fulfil the <code>data =</code> argument. <code>aes</code> is short for aesthetics, and it’s the function we use to specify what we want displayed in the figure.</p>
<p>If we did not include the <code>aes()</code> function, then the <code>x =</code> and <code>y =</code> arguments would produce an error saying that the object was not found. A good rule to keep in mind when using <code>ggplot2</code> is that the variables which we want displayed on the figure must be included in <code>aes()</code> function via the <code>mapping =</code> argument (corresponding to the mapping layer from Fig. 4.1).</p>
<p>All features in the figure which alter the displayed information, not based on a variable in our dataset (e.g. increasing the size of points to an arbitrary value), is included outside of the <code>aes()</code> function. Don’t worry if that doesn’t make sense for now, we’ll come back to this later.</p>
<p>Let’s update our code to include the data and mapping layers (indicated by the grey Data and mustard Mapping <em>layer bubbles</em> which will precede relevant code chunks):</p>
<center>
<img src="images/data.png" style="width:7.5%" /> <img src="images/mapping.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="co"># Including aesthetics for x and y axes as well as specifying the dataset</span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/ggplot%20with%20xy%20axis-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s already much better. At least it’s no longer a blank grey canvas. We’ve now told <code>ggplot2</code> what we want as our x and y axes as well as where to find that data. But what’s missing here is where we tell <code>ggplot2</code> <em>how</em> to display that data. This is now the time to introduce you to “geoms” or geometry layers.</p>
<p>Geometries are the way that <code>ggplot2</code> displays information. For instance <code>geom_point()</code> tells <code>ggplot2</code> that you want the information to be displayed as points (making scatterplots possible for example). Given that the “final figure” uses points, this is clearly the appropriate geom to use here.</p>
<p>Before we can do that, we need to talk about the coding structure used by <code>ggplot2</code>. The analogy that I and many others use is to say that making a figure in <code>ggplot2</code> is much like painting. What we’ve did in the above code was to make our “canvas”. Now we are going to add sequential layers to that painting, increasing the complexity and detail over time. Each time we want to include a new layer we need to end a preceding layer with a <code>+</code> at the end to tell R and <code>ggplot2</code> that there are additional layers coming.</p>
<p>Let’s add (<code>+</code>) a new geometry layer now:</p>
<center>
<img src="images/geoms.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-2" title="2"></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="st">  </span><span class="co"># Adding a geom to display data as point data</span></a>
<a class="sourceLine" id="cb84-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/ggplot%20with%20geom_point-1.png" width="75%" style="display: block; margin: auto;" /></p>
<hr />
<p>When you are starting with <code>ggplot2</code> there are three crucial layers that require your input. You can safely ignore the other layers initially as they all recieve sensible defaults (if sometimes ugly). The three crucial layers are:</p>
<center>
<p><img src="images/data.png" style="width:7.5%" /></p>
<p>Data - the information we want to plot.</p>
<p><img src="images/mapping.png" style="width:7.5%" /></p>
<p>Mapping - which variables of the data we want displayed and where.</p>
<p><img src="images/geoms.png" style="width:7.5%" /></p>
<p>Geometry - how we want that data displayed.</p>
</center>
<p>Given that data only requires us to specify the dataset we want to use, it is trivially easy to complete. Mapping only requires further specification of which variables in the data we want to use, often just the x- and y-axes (specified using <code>aes()</code>). Lastly, geometry is where we choose how we want the data to be visualised.</p>
<p>With just those three fundamentals, you will be able to produce a large variety of plots.</p>
<hr />
<p>If what we wanted was a quick and dirty figure to get a grasp of the trend in the data we can stop here. From the scatterplot that we’ve produced, we can see that shootarea looks like it’s increasing with weight in a linear fashion. So long as this answers the question we were asking from the data, we have a figure that is fit for purpose. Though for showing to other people we might want something a bit more developed. If we glance back to our “final figure” we can see that we have lines representing the different nitrogen concentrations. We can include lines using a geom. If you have a quick look through the available geoms [here][geoms], you might think that <code>geom_line()</code> would be appropriate. Let’s try it.</p>
<center>
<img src="images/geoms.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb85-3" title="3"></a>
<a class="sourceLine" id="cb85-4" title="4"><span class="st">  </span><span class="co"># Adding geom_line</span></a>
<a class="sourceLine" id="cb85-5" title="5"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_line-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Not quite what we were going for. The problem that we have is that <code>geom_line()</code> is actually just playing join-the-dots in the order they appear in the data (an alternative to <code>geom_path()</code>). The geom we actually want to use is called <code>geom_smooth()</code>. We can fix that very easily just by changing “line” to “smooth”.</p>
<center>
<img src="images/geoms.png" style="width:7.5%" /> <img src="images/statistics.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb86-3" title="3"></a>
<a class="sourceLine" id="cb86-4" title="4"><span class="st">  </span><span class="co"># Changing to geom_smooth</span></a>
<a class="sourceLine" id="cb86-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_smooth-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Better, but still not what we wanted. The challenge here is that drawing a line is actually somewhat complicated. The way our line above was drawn was by using a method called “LOESS” (locally estimated scatterplot smoothing) which gives something very close to a moving average; useful in some cases, less so in others. <code>ggplot2</code> will use LOESS as default when you have &lt; 1000 observations, so we’ll need to manually speicify the method. Instead of a wiggly line, we want a nice simple straight line to be drawn using a method called “lm” (short for linear model - see Chapter 5 for more details). Try looking at the help file, using <code>?geom_smooth</code>, to see what other options are available for the <code>method =</code> argument.</p>
<p>While we’re at it, let’s get rid of the confidence interval ribbon around the line. I prefer to do this as I think it’s clearer to the audience that this isn’t a properly analysed line and to treat it as a visual aid only. We can do this at the same time as changing the method by setting the <code>se =</code> argument (short for standard error) to FALSE.</p>
<p>Let’s update the code to use a linear model without confidence intervals.</p>
<center>
<img src="images/statistics.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb87-3" title="3"></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="st">  </span><span class="co"># Specifying the method as lm and se to false</span></a>
<a class="sourceLine" id="cb87-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_smooth%20lm-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We get the straight line that we wanted, though it’s still not matching the “final figure”. We need to alter <code>geom_smooth()</code> so that it draws lines for each level of nitrogen concentration. Getting <code>ggplot2</code> to do that is pretty straightforward. We can use the <code>colour =</code> argument within <code>aes()</code> (remember whatever we include in <code>aes()</code> will be something displayed in the figure) to tell <code>ggplot2</code> to draw a different coloured lines depending on nitrogen concentration. Keep in mind that we have no variable in our dataset called “nitrogen_colour”, so <code>ggplot2</code> is taking care of that for us here and assigning a colour to each unique nitrogen level.</p>
<p>An aside: <code>ggplot2</code> was written with both UK English and American English in mind, so both colour and color spellings work in <code>ggplot2</code>.</p>
<center>
<img src="images/mapping.png" style="width:7.5%" /> <img src="images/scales.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb88-3" title="3"></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="st">  </span><span class="co"># Including colour argument in aes()</span></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_smooth%20colour%20lm-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We’re getting closer, especially since <code>ggplot2</code> has automatically created a legend for us. At this point it’s a good time to talk about where to include information - whether to include it within a geom or in <code>ggplot()</code>. When we include information such as <code>data =</code> and <code>aes()</code> in <code>ggplot()</code> we are setting those as the default, universal values which all subsequent geoms use. Whereas if we were to include that information within a geom, only that geom would use that specific information. In this case, we can easily move the information around and get exactly the same figure.</p>
<center>
<img src="images/data.png" style="width:7.5%" /> <img src="images/mapping.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb89-2" title="2"></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="st">  </span><span class="co"># Moved aes() and data into geoms</span></a>
<a class="sourceLine" id="cb89-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb89-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/universal%20vrs%20geom-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Doing so we get exactly the same figure. This ability to move information between the universal <code>ggplot()</code> or specific geoms is surprisingly powerful. It can allow different geoms to display different (albeit similar) information (see more on this later).</p>
<p>For this worked example, we’ll move the same information back to the universal <code>ggplot()</code>,but we’ll also move <code>colour = nitrogen</code> into <code>ggplot()</code> so that we can have the points coloured according to nitrogen concentration as well.</p>
<center>
<img src="images/data.png" style="width:7.5%" /> <img src="images/mapping.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co"># Moved colour = nitrogen into the universal ggplot()</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb90-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/universal%20colours-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This figure is now what I would consider to be the typical <code>ggplot2</code> figure (once you know to look for it, you’ll see it everywhere). We have specified some information, with only a few lines of code at that, yet we have something that looks quite attractive. While it’s not yet the “final figure” it is perfectly suited for showing trends in the data. You have now created your first “pure” <code>ggplot</code> using only the data, mapping and geom layer (as well as others indirectly).</p>
<p>Let’s keep going as we’re aiming for something a bit more “sophisticated”.</p>
<p><br />
</p>
</div>
<div id="wrapping-grids" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Wrapping grids</h3>
<p>Having made our “pure” <code>ggplot</code>, the next big obstacle we’re going to tackle is the grid like layout of the “final figure” where the single figure has been split according to treatment and block, with new trends shown for each combination.</p>
<p>Each of these panels (technically “multiples”) are a great way to help other people understand what is going on in the data. This is especially true with large datasets which can obscure subtle trends simply because so much data is overlaid on top of each other. When we split a single figure into multiples, the same axes are used for all multiples which serve to highlight shifts in the data (data in some multiples may have inherently higher or lower values for instance).</p>
<p><code>ggplot2</code> includes options for determining the “facets” layer of a figure. We’ll start off by using <code>facet_wrap()</code> to show what this can do. For <code>facet_wrap()</code> to work we need to specify a formula for how the facets will be defined (see <code>?facet_wrap</code> for more details and also for how to define facets without using a formula). You can read <code>~ treat</code> as saying “according to treatment”. Let’s see how it works:</p>
<center>
<img src="images/facets.png" style="width:7.5%" />`
</center>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb91-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb91-4" title="4"></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="st">  </span><span class="co"># Splitting the single figure into multiple depending on treatment</span></a>
<a class="sourceLine" id="cb91-6" title="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_wrap-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s pretty good. Notice how we can see the impact that the tip treatment has on shoot area now (generally lowering shoot area), where in the previous figure we had no way of noticing this?</p>
<p>While good, we are missing the rows showing different blocks. Given that <code>facet_wrap()</code> can use a formula, maybe we could simply include block in the formula? Remember that block refers to the region in the greenhouse where the plants were grown. Let’s try it and see what happens.</p>
<center>
<img src="images/facets.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb92-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-4" title="4"></a>
<a class="sourceLine" id="cb92-5" title="5"><span class="st">  </span><span class="co"># Adding &quot;block&quot; to formula</span></a>
<a class="sourceLine" id="cb92-6" title="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>block)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_wrap%20formula-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This facet layout is almost exactly what we want. <em>Almost</em>. But not exactly. In this case we actually want to be using <code>facet_grid()</code>, an alternative to <code>facet_wrap()</code>, which should put us back on track to make the “final figure”.</p>
<hr />
<p><em>Play around</em>: Try changing the formula to see what happens. Something like <code>~ treat + flowers</code> or even <code>~ treat + block + flowers</code>. The important thing to remember here is that <code>facet_wrap()</code> will create a new figure for each value in a variable. So when you wrap using a continuous variable like flowers, it makes a plot for every unique number of flowers counted. Be aware of what it is you are doing, but never be scared to experiment. Mistakes are easily fixed in R - it’s not like a point and click programme where you’d have to go back through all those clicks to get the same figure produced Made a mistake? Easy, change it back and rerun the code (see Chapter 8 for version control which takes this to the next level).</p>
<hr />
<center>
<img src="images/facets.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-4" title="4"></a>
<a class="sourceLine" id="cb93-5" title="5"><span class="st">  </span><span class="co"># Changing to facet_grid</span></a>
<a class="sourceLine" id="cb93-6" title="6"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>block)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_grid-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s disappointing. It’s pretty much the same as what we had before and is no closer to the “final figure”. To fix this we need to do to rearrange our formula so that we say that it is block in relation to treatment (not in combination to).</p>
<center>
<img src="images/facets.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-4" title="4"></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="st">  </span><span class="co"># Rearranging formula, block in relation to treatment</span></a>
<a class="sourceLine" id="cb94-6" title="6"><span class="st">  </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/facet_grid%20formula-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
<div id="plotting-multiple-ggplots" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Plotting multiple ggplots</h3>
<p>And we’re there. Although the styling is not the same as the “final figure” this is showing the same core fundamental information. While we have made multiples of the same figure, what if we wanted to take two completely different figures and plot them together in the same frame? To show we can do this we can plot our current figure from above and the final figure side-by-side to see how they compare. To do so we will use an additional package called <code>patchwork</code>. Go ahead and install and load patchwork.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;patchwork&quot;</span>)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">library</span>(patchwork)</a></code></pre></div>
<pre><code># Warning: package &#39;patchwork&#39; was built under R version 3.6.3</code></pre>
<p>An important note: For those who have used base R to produce their figure and are familiar with using <code>par(mfrow = c(2,2))</code> (which allows plotting of four figures in two rows and two columns) be aware that this does not work for <code>ggplot2</code> objects. Instead you will need to use either the <code>patchwork</code> package or alternative packages such as <code>gridArrange</code> or <code>cowplot</code> or covert the <code>ggplot2</code> objects to grobs.</p>
<p>We’ll need to go back to our previous code and do something clever. We can assign figures a name and then use that to call the figure whenever we run the name. For instance, I have assigned the “final figure” the name…. <code>final_figure</code> (I’m not a clever person). You may see this method used a lot in other textbooks or online, especially when adding addition layers (e.g. <code>final_figure + geom_point()</code>). Something like this:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y))</a></code></pre></div>
<p>And later to add additional layers, people do:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p>I prefer not to do use that approach here, instead favouring that the entire code is always visible to you while reading this book. Regardless, let’s remind ourselves of the final figure.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">final_figure</a></code></pre></div>
<p><img src="Rbook_files/figure-html/calling%20figure%20name-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We’ll do the same with the figure we’ve created together:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="co"># Naming our figure object</span></a>
<a class="sourceLine" id="cb100-2" title="2">rbook_figure &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="st">  </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p>Now when the code is run, the figure won’t be shown. This will only happen when we run the name of the figure as code. Well use this at the same time as showing how <code>patchwork</code> works.</p>
<p>An old headache when using <code>ggplot2</code> was that it could be difficult to create a nested figure (different plots, or “multiples”, all part of the same dataset). <code>patchwork</code> resolves this problem very elegantly and simply. We have two immediate and simple options with patchwork; figures on top of each other (operationalised with <code>/</code>) and figures side-by-side (operationalised with either <code>+</code> or <code>|</code>). Let’s try.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">rbook_figure <span class="op">/</span><span class="st"> </span>final_figure</a></code></pre></div>
<p><img src="Rbook_files/figure-html/side-by-side%20patchwork-1.png" width="85%" style="display: block; margin: auto;" /></p>
<p>Giving us a nested stacked figure.</p>
<hr />
<p><em>Play around</em>: Try to create a side-by-side version of the above figure (hint: try the other operators).</p>
<hr />
<p>We can also assign nested <code>patchwork</code> figures a name and use this in turn to create labels for individuals figures.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">nested_compare &lt;-<span class="st"> </span>rbook_figure <span class="op">/</span><span class="st"> </span>final_figure</a>
<a class="sourceLine" id="cb102-2" title="2"></a>
<a class="sourceLine" id="cb102-3" title="3">nested_compare <span class="op">+</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="st">  </span><span class="kw">plot_annotation</span>(<span class="dt">tag_levels =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">tag_suffix =</span> <span class="st">&quot;)&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/labelled%20nested-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This is only the basics of what the patchwork package can do but there are many other uses. We won’t go into them in any great detail here, but later in the tips and tricks section I’ll show some more features.</p>
<p><br />
</p>
</div>
<div id="make-it-your-own" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Make it your own</h3>
<p>While we have a great figure already that shows the data we want it to show, it uses many default layer options. While the default options are arguably fine, they may not be what we want ourselves. Maybe we’re going to use this figure in a presentation and we want to make sure someone in the very back of the room can easily read the figure. Maybe we want to use our own colour scheme. Maybe we want to change the grey background to a nice bright neon pink. In essence, maybe we want to decide things for ourselves. This next section will go through how to customise the appearance of our figure.</p>
<p>Let’s start with the easier stuff, namely changing the size of the points using the <code>size =</code> argument. Before we do, have a think about where we’d include the argument? Should it be in <code>ggplot()</code> or <code>geom_point()</code>? Does size depend on a variable in our dataset and is therefore something we want displayed on the figure (meaning we should include it within <code>aes()</code>)? Or is it merely changing the appearance of information?</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb103-3" title="3"><span class="st">    </span><span class="co"># Including size argument to change the size of the points</span></a>
<a class="sourceLine" id="cb103-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb103-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-7" title="7"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/change%20size-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Straightforward, we changed the size from the default of <code>size = 1</code> to a value that we decide for ourselves. What happens if you included size in <code>ggplot()</code> or within the <code>aes()</code> of <code>geom_point()</code>?</p>
<p>If we wanted to change the shape of the points to reflect nitrogen concentrations, how do you think we’d do that? We’d use the <code>shape =</code> argument, but this time we need to include an <code>aes()</code> within <code>geom_point()</code> because we want to include specific information to be displayed on the figure. We indirectly make use of the scales layer here when we map nitrogen to shape as <code>ggplot2</code> will automatically translate our factor into a shape.</p>
<center>
<img src="images/scales.png" style="width:7.5%" /> <img src="images/mapping.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb104-3" title="3"><span class="st">    </span><span class="co"># Including shape argument to change the shape of the points</span></a>
<a class="sourceLine" id="cb104-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb104-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-7" title="7"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/change%20shape-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Try including <code>shape = nitrogen</code> without also including <code>aes()</code> and see what happens.</p>
<p>We’re getting closer and closer to the “final figure”. Another thing we may want to be able to do is change the transparency of the points. While it’s not actually that crucial here (arguably it might not be a good idea), changing the transparency of points is really valuable when you have lots of data and big clusters of points hide the amount of information. Doing this is easily accomplished using the <code>alpha =</code> argument. Again, ask yourself where you think the <code>alpha =</code> argument should be included.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="st">    </span><span class="co"># Including alpha argument to change the transparency of the points</span></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb105-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-7" title="7"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/change%20alpha-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can also include defined labels for the x and y axis. There are a couple of ways to do this, but a more familiar way may be to use the same syntax as used in base R figures; using <code>xlab()</code> and <code>ylab()</code>. We’ll specify that these belong to the <code>ggplot</code> by using <code>+</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb106-6" title="6"><span class="st">    </span><span class="co"># Adding layers for x and y labels</span></a>
<a class="sourceLine" id="cb106-7" title="7"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-8" title="8"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Area of shoot (cm^2)&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/axis%20labels-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Great. Just as we wanted, though getting the “(cm^2)” to show the square as a superscript would be ideal. Here, we’re going to accomplish that using a function which is part of base R called <code>bquote()</code> which allows for special characters to be shown.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-6" title="6"><span class="st">    </span></a>
<a class="sourceLine" id="cb107-7" title="7"><span class="st">    </span><span class="co"># Using bquote to get mathematically correct formatting</span></a>
<a class="sourceLine" id="cb107-8" title="8"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<p><img src="Rbook_files/figure-html/bquote-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Let’s now work on the legend title while also including a caption to warn people looking at the figure to treat the trend lines with caution. We’ll use a new layer called <code>labs()</code>, short for labels, which we could have also used for specifying the x and y labels (we didn’t only for demonstration purposes, but give it a shot). <code>labs()</code> is a fairly straightforward function. Have a look at the help file (using <code>?labs</code>) to see which arguments are available. We’ll be using <code>caption =</code> for the caption, but notice that there isn’t a single simple argument for <code>legend =</code>? That’s because the legend actually contains multiple pieces of information; one being colour and one being shape. So instead of <code>legend =</code> we’ll use <code>colour =</code> and <code>shape =</code>. Here’s how we do it:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-7" title="7"></a>
<a class="sourceLine" id="cb108-8" title="8"><span class="st">    </span><span class="co"># Adding labels for shape, colour and a caption </span></a>
<a class="sourceLine" id="cb108-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/extra%20labels-1.png" width="75%" style="display: block; margin: auto;" /></p>
<hr />
<p><em>Play around</em>: Try removing <code>colour =</code> or <code>shape =</code> from <code>labs()</code> to see what happens. The resulting legends are why we need to specify both colour and shape (and call it the same thing).</p>
<hr />
<p>Now is a good time to introduce “backslash n”. This is a base R feature which can be thought of as pressing Return in a word processor. It tells R that a string should be continued on a new line. We can use that with “Nitrogen Concentration” so that the legend title becomes more compact.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-7" title="7"></a>
<a class="sourceLine" id="cb109-8" title="8"><span class="st">    </span><span class="co"># Including \n to split legend title over two lines </span></a>
<a class="sourceLine" id="cb109-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/compact%20labels-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can now move onto some more wholesale-stylistic choices using the themes layer.</p>
<p><br />
</p>
</div>
<div id="setting-the-theme" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Setting the theme</h3>
<p><code>ggplot2</code> contains so called themes. Themes control the general style of a <code>ggplot</code> (things like the background colour, size of text etc.). Let’s play around with themes using some skills we’ve already learnt; assigning plots a name and plotting multiple <code>ggplots</code> in a single figure to explore some theme options. We assign themes by creating a new layer with <code>theme_X()</code>.</p>
<center>
<img src="images/theme.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">classic &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-8" title="8"><span class="st">    </span></a>
<a class="sourceLine" id="cb110-9" title="9"><span class="st">    </span><span class="co"># Classic theme</span></a>
<a class="sourceLine" id="cb110-10" title="10"><span class="st">    </span><span class="kw">theme_classic</span>()</a>
<a class="sourceLine" id="cb110-11" title="11"></a>
<a class="sourceLine" id="cb110-12" title="12">bw &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-13" title="13"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-14" title="14"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-15" title="15"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-16" title="16"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-17" title="17"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-18" title="18"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-19" title="19"><span class="st">    </span></a>
<a class="sourceLine" id="cb110-20" title="20"><span class="st">    </span><span class="co"># Black and white theme</span></a>
<a class="sourceLine" id="cb110-21" title="21"><span class="st">    </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb110-22" title="22"></a>
<a class="sourceLine" id="cb110-23" title="23">minimal &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-24" title="24"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-25" title="25"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-26" title="26"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-27" title="27"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-28" title="28"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-29" title="29"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-30" title="30"></a>
<a class="sourceLine" id="cb110-31" title="31"><span class="st">    </span><span class="co"># Minimal theme</span></a>
<a class="sourceLine" id="cb110-32" title="32"><span class="st">    </span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb110-33" title="33"></a>
<a class="sourceLine" id="cb110-34" title="34">light &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-35" title="35"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-36" title="36"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-37" title="37"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-38" title="38"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-39" title="39"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-40" title="40"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-41" title="41"></a>
<a class="sourceLine" id="cb110-42" title="42"><span class="st">    </span><span class="co"># Light theme</span></a>
<a class="sourceLine" id="cb110-43" title="43"><span class="st">    </span><span class="kw">theme_light</span>()</a>
<a class="sourceLine" id="cb110-44" title="44"></a>
<a class="sourceLine" id="cb110-45" title="45">(classic <span class="op">|</span><span class="st"> </span>bw) <span class="op">/</span></a>
<a class="sourceLine" id="cb110-46" title="46"><span class="st">    </span>(minimal <span class="op">|</span><span class="st"> </span>light)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/testing%20themes-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>In terms of finding a theme that most closely matches our “final figure”, it’s probably going to be <code>theme_classic()</code>. There are additional themes available to you, and even more available online. <code>ggthemes</code> is a package which contains many more themes for you to use. The BBC even have their own <code>ggplot2</code> theme called “BBplot” which they use when making their own figures (while good, I don’t like it too much for scientific figures). Indeed, you can even make your own theme which is what we’ll work on next. To begin with, we’ll have a look to see how <code>theme_classic()</code> was coded. We can do that easily enough by just writing the function name without the paranetheses (see Chapter 6 for a bit more on this).</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">theme_classic</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="co"># function (base_size = 11, base_family = &quot;&quot;, base_line_size = base_size/22, </span></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="co">#     base_rect_size = base_size/22) </span></a>
<a class="sourceLine" id="cb111-4" title="4"><span class="co"># {</span></a>
<a class="sourceLine" id="cb111-5" title="5"><span class="co">#     theme_bw(base_size = base_size, base_family = base_family, </span></a>
<a class="sourceLine" id="cb111-6" title="6"><span class="co">#         base_line_size = base_line_size, base_rect_size = base_rect_size) %+replace% </span></a>
<a class="sourceLine" id="cb111-7" title="7"><span class="co">#         theme(panel.border = element_blank(), panel.grid.major = element_blank(), </span></a>
<a class="sourceLine" id="cb111-8" title="8"><span class="co">#             panel.grid.minor = element_blank(), axis.line = element_line(colour = &quot;black&quot;, </span></a>
<a class="sourceLine" id="cb111-9" title="9"><span class="co">#                 size = rel(1)), legend.key = element_blank(), </span></a>
<a class="sourceLine" id="cb111-10" title="10"><span class="co">#             strip.background = element_rect(fill = &quot;white&quot;, colour = &quot;black&quot;, </span></a>
<a class="sourceLine" id="cb111-11" title="11"><span class="co">#                 size = rel(2)), complete = TRUE)</span></a>
<a class="sourceLine" id="cb111-12" title="12"><span class="co"># }</span></a>
<a class="sourceLine" id="cb111-13" title="13"><span class="co"># &lt;bytecode: 0x000000002580c718&gt;</span></a>
<a class="sourceLine" id="cb111-14" title="14"><span class="co"># &lt;environment: namespace:ggplot2&gt;</span></a></code></pre></div>
<p>Let’s use this code as the basis for our own theme and modify it according to our needs. We’ll call the theme, <code>theme_rbook</code>. Not all of the options will immediately make sense, but don’t worry about this too much for now. Just know that the settings we’re putting in place are:</p>
<ul>
<li>Font size for axis titles = 13</li>
<li>Font size for x axis text = 10</li>
<li>Font size for y axis text = 10</li>
<li>Font for caption = 10 and italics</li>
<li>Background colour = white</li>
<li>Background border = black</li>
<li>Axis lines = black</li>
<li>Strip colour (for facets) = light blue</li>
<li>Strip text colour (for facets) = black</li>
<li>Legend box colours = No colour</li>
</ul>
<p>This is by no means an exhaustive list of features you can specify in your own theme, but this will get you started. Of course, there is no need to use a personalised theme as the pre-built options are perfectly suitable.</p>
<center>
<img src="images/theme.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">theme_rbook &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">base_size =</span> <span class="dv">13</span>, <span class="dt">base_family =</span> <span class="st">&quot;&quot;</span>, <span class="dt">base_line_size =</span> base_size<span class="op">/</span><span class="dv">22</span>, <span class="dt">base_rect_size =</span> base_size<span class="op">/</span><span class="dv">22</span>) {         </a>
<a class="sourceLine" id="cb112-2" title="2">  <span class="kw">theme</span>( </a>
<a class="sourceLine" id="cb112-3" title="3">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>),                               </a>
<a class="sourceLine" id="cb112-4" title="4">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),                              </a>
<a class="sourceLine" id="cb112-5" title="5">    <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),                              </a>
<a class="sourceLine" id="cb112-6" title="6">    <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>),            </a>
<a class="sourceLine" id="cb112-7" title="7">    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>),                      </a>
<a class="sourceLine" id="cb112-8" title="8">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb112-9" title="9">    <span class="dt">strip.background =</span><span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;#cddcdd&quot;</span>),</a>
<a class="sourceLine" id="cb112-10" title="10">    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb112-11" title="11">        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb112-12" title="12">        <span class="dt">legend.key=</span><span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb112-13" title="13">  )</a>
<a class="sourceLine" id="cb112-14" title="14">}</a></code></pre></div>
<p><code>theme_rbook()</code> is now available for us to use just like any other theme. Let’s try remaking our figure using our new theme.</p>
<center>
<img src="images/theme.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-8" title="8"></a>
<a class="sourceLine" id="cb113-9" title="9"><span class="st">    </span><span class="co"># Updated theme to our theme_rbook</span></a>
<a class="sourceLine" id="cb113-10" title="10"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/rbook%20figure-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="prettification" class="section level3">
<h3><span class="header-section-number">4.2.6</span> Prettification</h3>
<p>We’ve pretty much replicated our “final figure”. We just have a few final adjustments to make, and we’ll do so in order of difficulty.</p>
<p>Let’s remind ourselves of what that “final figure” looked like. Remember, since I have previously stored the figure as <code>final_figure</code> I can just type that into the console and pull up the figure.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">final_figure <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Reminder of the final figure&quot;</span>)</a></code></pre></div>
<p><img src="Rbook_files/figure-html/final%20figure%20reminder-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Let’s begin the final push by including that dashed horizontal line at the average shoot area, about 80, on our y axis. This represents the overall mean area of a shoot, regardless of weight of flower, nitrogen concentration, treatment, or block. To draw a horizontal line we use a geom called <code>geom_hline()</code>, and the most important thing we need to specify is the y intercept value (in this case being our mean area of a shoot). We can also change the type of line using the argument <code>linetype =</code> and also the colour (as we did before). Let’s see how it works.</p>
<center>
<img src="images/geoms.png" style="width:7.5%" /> <img src="images/mapping.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-8" title="8"></a>
<a class="sourceLine" id="cb115-9" title="9"><span class="st">    </span><span class="co"># Added a horizontal line using geom_hline</span></a>
<a class="sourceLine" id="cb115-10" title="10"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(shootarea)), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-11" title="11"><span class="st">    </span></a>
<a class="sourceLine" id="cb115-12" title="12"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_hline-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Notice how we included the function <code>mean(shootarea)</code> within the <code>geom_hline()</code> function? We could also do that externally to the <code>ggplot2</code> code and get the same result.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">mean</span>(flower<span class="op">$</span>shootarea)</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="co"># [1] 79.78</span></a></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-4" title="4"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-8" title="8"></a>
<a class="sourceLine" id="cb117-9" title="9"><span class="st">    </span><span class="co"># Manually entering mean value</span></a>
<a class="sourceLine" id="cb117-10" title="10"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb117-11" title="11"><span class="st">    </span></a>
<a class="sourceLine" id="cb117-12" title="12"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_hline%20alternative-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Exactly the same figure but produced in a slightly different way (the point being that there are always multiple ways to get what you want), which brings us ever closer to that “final figure”.</p>
<p>Let’s tackle that “overall” nitrogen effect. This overall line is effectively the figure we produced much earlier when we learnt how to produce a line drawn using a linear model. But we are already using <code>geom_smooth()</code>, surely we can’t use it again? This may shock and/or surprise you so please ensure you are seated. You <em>can</em> use <code>geom_smooth()</code> again. In fact you can use it as many times as you want. You can use any layer as many times as you want! Isn’t the world full of wonderful miracles? … Anyway, here’s the damn code…</p>
<center>
<img src="images/geoms.png" style="width:7.5%" /> <img src="images/statistics.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-4" title="4"><span class="st">    </span></a>
<a class="sourceLine" id="cb118-5" title="5"><span class="st">    </span><span class="co"># Adding a ***SECOND*** geom_smooth :O</span></a>
<a class="sourceLine" id="cb118-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-7" title="7"><span class="st">    </span></a>
<a class="sourceLine" id="cb118-8" title="8"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-9" title="9"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-10" title="10"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-11" title="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-12" title="12"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-13" title="13"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/2nd%20geom_smooth-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>That’s great! But you should be asking yourself why that worked. Why when we specified the first <code>geom_smooth()</code> did it draw 3 lines, whereas the second time we used <code>geom_smooth()</code> it just drew a single line? The secret lies in a “conflict” (it isn’t actually a conflict but I’ll call it that here) between the colour specified in the universal <code>ggplot()</code> and the colour specified in the second <code>geom_smooth()</code>. Notice how in the second we’ve specifically told <code>ggplot2</code> that the colour will be black, while prior to this it drew lines based on the number of groups (or colours) in nitrogen? In “overriding” the universal <code>ggplot()</code> with a geom specific argument we’re able to get <code>ggplot2</code> to plot what we want.</p>
<p>The only things left now are to change the colour and the shape of the points to something of our choosing and include the “overall” trend line in the legend. We’ll begin with the former; changing colour and shape to something we specifically want. When I first started using <code>ggplot2</code> this was the thing which caused me the most difficulty. I think the reason is, that to manually change the colours actually requires an additional layer, where I assumed this would be done in either the universal <code>ggplot()</code> or in a geom.</p>
<p>Instead of doing this within the specific geom, we’ll use <code>scale_colour_manual()</code> as well as <code>scale_shape_manual()</code>. Doing it this way will allow us to do two things at once; change the shape and colour to our choosing, and assign labels for these (much like what we did with <code>xlab()</code> and <code>ylab()</code>). Doing so is not too complex but will require nesting a function within another function, using <code>c()</code> (see chapter 2 for a reminder on the concatenate function).</p>
<p>Choosing colours can be fiddly. I’ve found using a colour wheel helps with this step. You can always use Google to find an interactive colour wheel, or use Google’s Colour picker. Any decent website should give you a string, something like: #5C1AAE which are the “code” representations of those colours (called a “HEX”, which both R and <code>ggplot2</code> understand). Alternatively, there are colour names which R and <code>ggplot2</code> will also understand (e.g. “firebrick4”). Having chosen our colours using whichever means, let’s see how we can do it:</p>
<center>
<img src="images/scales.png" style="width:7.5%" />
</center>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-5" title="5"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-6" title="6"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-7" title="7"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-9" title="9"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-10" title="10"><span class="st">    </span></a>
<a class="sourceLine" id="cb119-11" title="11"><span class="st">    </span><span class="co"># Setting colour and associated labels</span></a>
<a class="sourceLine" id="cb119-12" title="12"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb119-13" title="13">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-14" title="14"><span class="st">    </span></a>
<a class="sourceLine" id="cb119-15" title="15"><span class="st">    </span><span class="co"># Setting shape and associated labels</span></a>
<a class="sourceLine" id="cb119-16" title="16"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb119-17" title="17">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-18" title="18"><span class="st">    </span></a>
<a class="sourceLine" id="cb119-19" title="19"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/scale%20manual-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>To make sense of that code (or any code for that matter) try running it piece by piece. For instance in the above code, if we run <code>c("violetred3", "limegreen", "purple4")</code> we’ll get a list of those strings. That list is then passed on to <code>scale_colour_manual()</code> as the colours we wish to use. Since we only have three nitrogen concentrations, it will use these three colours. Try including an additional colour in the list and see what happens (if you place the new colour at the end of the list, nothing will happen since it will use the first three colours of the list - try adding it to the start of the list). The same is true for <code>scale_shape_manual()</code>.</p>
<p>But if you’re paying close attention you’ll notice that there’s a mistake with the figure now. What should be labelled “Low” is actually labelled “Medium” (the green points and line are our low nitrogen concentration, but <code>ggplot2</code> is saying that it is purple). <code>ggplot2</code> hasn’t made a mistake here. We have. Remember that code is purely logical. It will do explicitly what it is told to do, and in this case we have told it to call the labels High, Medium and Low. We could have just as easily told <code>ggplot2</code> to call them Pretoria, Tokyo, and Copenhagen. The lesson here is to always be critical of what your outputs are. Double check everything you do.</p>
<p>So how do we fix this? We need to do a little data manipulation to rearrange our factors so that the order goes High, Medium, Low. Let’s do that:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">flower<span class="op">$</span>nitrogen &lt;-<span class="st"> </span><span class="kw">factor</span>(flower<span class="op">$</span>nitrogen, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;low&quot;</span>))</a></code></pre></div>
<p>With that done, we can re-run our above code to get a correct figure and assign it the name “rbook_figure”.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">rbook_figure &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-5" title="5"><span class="st">    </span><span class="kw">facet_grid</span>(block <span class="op">~</span><span class="st"> </span>treat) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-6" title="6"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-7" title="7"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Regression assumptions are unvalidated&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-9" title="9"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-10" title="10"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb121-11" title="11">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-12" title="12"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb121-13" title="13">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-14" title="14"><span class="st">    </span><span class="kw">theme_rbook</span>()</a>
<a class="sourceLine" id="cb121-15" title="15"></a>
<a class="sourceLine" id="cb121-16" title="16">rbook_figure</a></code></pre></div>
<p><img src="Rbook_files/figure-html/corrected%20factor%20level-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>And we’ve done it! Our final figure matches the “final figure” exactly. We can then save the final figure to our computer so that we can include it in a poster etc. The code for this is straightforward, but does require an understanding of file paths. Be sure to check Chapter 1 for an explanation of this if you’re unsure.</p>
<p>This is the point when having assigned the code to the object named <code>rbook_figure</code> comes in handy. Doing so allows us to specify which figure it is we want to save within <code>ggsave()</code>. If we hadn’t specified which plot to save, <code>ggsave()</code> would instead save the most current figure produced.</p>
<p>Other important arguments to take note of are: <code>device =</code> where we tell <code>ggplot2</code> in what form we want the figure saved as (in this case saved as a .pdf) though <code>ggplot2</code> is often smart enough to guess this based on the extension we give our file name, so it is often redundant; <code>units =</code> which specifies the units used in <code>width =</code> and <code>height =</code>; <code>width =</code> and <code>height =</code> which specify the width and height of figure (in this case in mm as per <code>units =</code>); <code>dpi =</code> which controls the resolution of the saved figure; and <code>limitsize =</code> which prevents accidentally saving a figure of e.g. 1 km x 1 km.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;areashoot_weight_facet.pdf&quot;</span>, <span class="dt">plot =</span> rbook_figure, <span class="dt">device =</span> <span class="st">&quot;pdf&quot;</span>, <span class="dt">path =</span> <span class="st">&quot;C:</span><span class="ch">\\</span><span class="st">Users</span><span class="ch">\\</span><span class="st">A.Nobel</span><span class="ch">\\</span><span class="st">Prize&quot;</span>,</a>
<a class="sourceLine" id="cb122-2" title="2">             <span class="dt">width =</span> <span class="dv">250</span>, <span class="dt">height =</span> <span class="dv">150</span>, <span class="dt">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="dt">dpi =</span> <span class="dv">500</span>, <span class="dt">limitsize =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>This concludes the worked example to reproduce our final figure. While absolutely not an exhaustive list of what you can do with <code>ggplot2</code>, this will hopefully help when you’re making your own from scratch or, perhaps likely when starting, copying <code>ggplots</code> made by other people (in which case hopefully this will help you understand what they’ve done).</p>
<p>Two sections follow this one. The first is simply a collection of tips and tricks that couldn’t quite make their way into this worked example, and the second section is a collection of different geometries to give you a feel for what’s possible. I would recommend only glancing through each section and coming back to them as and when you need to know how to do <em>that particular thing</em>.</p>
<p>I want to finish this chapter by saying that I hope you enjoyed it, and more importantly, that you increased your confidence in making figures. If I can have two final parting words, the first would be to reiterate not to fall into the trap of thinking your figures are superior to those who don’t use <code>ggplot2</code>. As I said in the beginning, equivalent figures are possible in both base R and <code>ggplot2</code>. The only difference is how you get to those figures.</p>
<p>The last advice I will give is to warn against overcomplicating your figures. With regards to the final figure we produced here, I have gone back and forth as to whether I think I have been guilty of that here. The figure does contain a lot of information, drawing on information from five different variables, with one of those being presented in three different ways. I would be reluctant, for example, to include this in a presentation as it would likely be too much for an audience to fully appreciate in the 30 seconds to 1 minute that they’ll see it. In the end I decided it was worth the risk as it served as a nice demonstration. Fortunately, or unfortunately depending on your view, there are no true hard and fast rules when it comes to making figures. Much of it will be at your discretion, so please ensure you give it thought. Sincerely, a viewer of one of your future conference posters, a future audience memeber at one of your talks, and a future reader of one of your papers.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="beginning-at-the-end.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tips-and-tricks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexd106/Rbook/edit/master/04-graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
