<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.3 Tips and tricks | A Introduction to R</title>
  <meta name="description" content="An Introduction to R" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="4.3 Tips and tricks | A Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to R" />
  <meta name="github-repo" content="alexd106/Rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.3 Tips and tricks | A Introduction to R" />
  
  <meta name="twitter:description" content="An Introduction to R" />
  

<meta name="author" content="Alex Douglas, Francesca Mancini, Deon Roos, Ana Couto &amp; David Lusseau" />


<meta name="date" content="2019-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-start-of-the-end.html"/>
<link rel="next" href="a-ggplot-beastiary.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started-with-r-and-rstudio.html"><a href="getting-started-with-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="install-r.html"><a href="install-r.html"><i class="fa fa-check"></i><b>1.1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="install-r.html"><a href="install-r.html#windows-users"><i class="fa fa-check"></i><b>1.1.1</b> Windows users</a></li>
<li class="chapter" data-level="1.1.2" data-path="install-r.html"><a href="install-r.html#mac-users"><i class="fa fa-check"></i><b>1.1.2</b> Mac users</a></li>
<li class="chapter" data-level="1.1.3" data-path="install-r.html"><a href="install-r.html#linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Linux users</a></li>
<li class="chapter" data-level="1.1.4" data-path="install-r.html"><a href="install-r.html#testing-r"><i class="fa fa-check"></i><b>1.1.4</b> Testing R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="installing-rstudio.html"><a href="installing-rstudio.html#windows-and-mac-users"><i class="fa fa-check"></i><b>1.2.1</b> Windows and Mac users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html#linux-users-1"><i class="fa fa-check"></i><b>1.2.2</b> Linux users</a></li>
<li class="chapter" data-level="1.2.3" data-path="installing-rstudio.html"><a href="installing-rstudio.html#testing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Testing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html"><i class="fa fa-check"></i><b>1.3</b> RStudio orientation</a><ul>
<li class="chapter" data-level="1.3.1" data-path="rstudio-orient.html"><a href="rstudio-orient.html#console"><i class="fa fa-check"></i><b>1.3.1</b> Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="rstudio-orient.html"><a href="rstudio-orient.html#environment-history-files"><i class="fa fa-check"></i><b>1.3.2</b> Environment / History / Files</a></li>
<li class="chapter" data-level="1.3.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html#plots-help-viewer"><i class="fa fa-check"></i><b>1.3.3</b> Plots / Help / Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html"><i class="fa fa-check"></i><b>1.4</b> Alternatives to RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>1.5</b> R packages</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-packages.html"><a href="r-packages.html#cran_packages"><i class="fa fa-check"></i><b>1.5.1</b> CRAN packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-packages.html"><a href="r-packages.html#bioconductor-packages"><i class="fa fa-check"></i><b>1.5.2</b> Bioconductor packages</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-packages.html"><a href="r-packages.html#github-packages"><i class="fa fa-check"></i><b>1.5.3</b> GitHub packages</a></li>
<li class="chapter" data-level="1.5.4" data-path="r-packages.html"><a href="r-packages.html#using-packages"><i class="fa fa-check"></i><b>1.5.4</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="writing-r-code.html"><a href="writing-r-code.html"><i class="fa fa-check"></i><b>1.6</b> Writing R code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-r.html"><a href="basics-r.html"><i class="fa fa-check"></i><b>2</b> Some R Basics</a></li>
<li class="chapter" data-level="3" data-path="data-r.html"><a href="data-r.html"><i class="fa fa-check"></i><b>3</b> Data in R</a></li>
<li class="chapter" data-level="4" data-path="graphics-r.html"><a href="graphics-r.html"><i class="fa fa-check"></i><b>4</b> Graphics in R</a><ul>
<li class="chapter" data-level="4.1" data-path="beginning-at-the-end.html"><a href="beginning-at-the-end.html"><i class="fa fa-check"></i><b>4.1</b> Beginning at the end</a></li>
<li class="chapter" data-level="4.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html"><i class="fa fa-check"></i><b>4.2</b> The start of the end</a><ul>
<li class="chapter" data-level="4.2.1" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#the-purest-of-ggplots"><i class="fa fa-check"></i><b>4.2.1</b> The purest of ggplots</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#wrapping-grids"><i class="fa fa-check"></i><b>4.2.2</b> Wrapping grids</a></li>
<li class="chapter" data-level="4.2.3" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#plotting-multiple-ggplots"><i class="fa fa-check"></i><b>4.2.3</b> Plotting multiple ggplots</a></li>
<li class="chapter" data-level="4.2.4" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#make-it-your-own"><i class="fa fa-check"></i><b>4.2.4</b> Make it your own</a></li>
<li class="chapter" data-level="4.2.5" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#setting-the-theme"><i class="fa fa-check"></i><b>4.2.5</b> Setting the theme</a></li>
<li class="chapter" data-level="4.2.6" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#prettification"><i class="fa fa-check"></i><b>4.2.6</b> Prettification</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html"><i class="fa fa-check"></i><b>4.3</b> Tips and tricks</a><ul>
<li class="chapter" data-level="4.3.1" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#axis-limits-and-zooms"><i class="fa fa-check"></i><b>4.3.1</b> Axis limits and zooms</a></li>
<li class="chapter" data-level="4.3.2" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#layering-layers"><i class="fa fa-check"></i><b>4.3.2</b> Layering layers</a></li>
<li class="chapter" data-level="4.3.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#moving-the-legend"><i class="fa fa-check"></i><b>4.3.3</b> Moving the legend</a></li>
<li class="chapter" data-level="4.3.4" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#hiding-the-legend"><i class="fa fa-check"></i><b>4.3.4</b> Hiding the legend</a></li>
<li class="chapter" data-level="4.3.5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#hiding-part-of-the-legend"><i class="fa fa-check"></i><b>4.3.5</b> Hiding part of the legend</a></li>
<li class="chapter" data-level="4.3.6" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#writing-on-a-figure"><i class="fa fa-check"></i><b>4.3.6</b> Writing on a figure</a></li>
<li class="chapter" data-level="4.3.7" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#tick-for-tack"><i class="fa fa-check"></i><b>4.3.7</b> Tick for tack</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="a-ggplot-beastiary.html"><a href="a-ggplot-beastiary.html"><i class="fa fa-check"></i><b>4.4</b> A ggplot Beastiary</a><ul>
<li class="chapter" data-level="4.4.1" data-path="a-ggplot-beastiary.html"><a href="a-ggplot-beastiary.html#density-plot"><i class="fa fa-check"></i><b>4.4.1</b> Density plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="a-ggplot-beastiary.html"><a href="a-ggplot-beastiary.html#histogram"><i class="fa fa-check"></i><b>4.4.2</b> Histogram</a></li>
<li class="chapter" data-level="4.4.3" data-path="a-ggplot-beastiary.html"><a href="a-ggplot-beastiary.html#boxplot"><i class="fa fa-check"></i><b>4.4.3</b> Boxplot</a></li>
<li class="chapter" data-level="4.4.4" data-path="a-ggplot-beastiary.html"><a href="a-ggplot-beastiary.html#violin-plots"><i class="fa fa-check"></i><b>4.4.4</b> Violin plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats-r.html"><a href="stats-r.html"><i class="fa fa-check"></i><b>5</b> Simple Statistics in R</a></li>
<li class="chapter" data-level="6" data-path="prog-r.html"><a href="prog-r.html"><i class="fa fa-check"></i><b>6</b> Programming in R</a></li>
<li class="chapter" data-level="7" data-path="rmarkdown-r.html"><a href="rmarkdown-r.html"><i class="fa fa-check"></i><b>7</b> Reproducible reports</a></li>
<li class="chapter" data-level="8" data-path="github-r.html"><a href="github-r.html"><i class="fa fa-check"></i><b>8</b> Version control with Git and GitHub</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tips-and-tricks" class="section level2">
<h2><span class="header-section-number">4.3</span> Tips and tricks</h2>
<p>For this section I’ll use the version of the final figure without the <code>facet_grid()</code>. With this plot, I’ll run through some tips and tricks that I wish I had learnt when I started using <code>ggplot2</code>.</p>
<div id="axis-limits-and-zooms" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Axis limits and zooms</h3>
<p>Fairly often, you may want to limit the range of your axes. Maybe you want to focus a particular part of the data to really tease apart any patterns occuring there. Whatever the reason, it’s a useful skill to know, and with most things code, there are a couple of ways to do this. I’ll show two here; <code>xlim()</code> and <code>ylim()</code> and <code>coord_cartesian()</code>. Using both of these we’ll set the x axis to only show data between 10 and 15 g and the yaxis to only show the area of the shoot between 50 and 150. We’ll start with limiting the axes:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen, <span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-7" title="7"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.7833</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-9" title="9"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb56-10" title="10">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-11" title="11"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">21</span>),</a>
<a class="sourceLine" id="cb56-12" title="12">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-13" title="13"><span class="st">    </span><span class="kw">theme_rbook</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb56-14" title="14"><span class="st">    </span></a>
<a class="sourceLine" id="cb56-15" title="15"><span class="st">    </span><span class="co"># New x and y limits</span></a>
<a class="sourceLine" id="cb56-16" title="16"><span class="st">    </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-17" title="17"><span class="st">    </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">150</span>))</a>
<a class="sourceLine" id="cb56-18" title="18"><span class="co">#&gt; Warning: Removed 68 rows containing non-finite values (stat_smooth).</span></a>
<a class="sourceLine" id="cb56-19" title="19"></a>
<a class="sourceLine" id="cb56-20" title="20"><span class="co">#&gt; Warning: Removed 68 rows containing non-finite values (stat_smooth).</span></a>
<a class="sourceLine" id="cb56-21" title="21"><span class="co">#&gt; Warning: Removed 68 rows containing missing values (geom_point).</span></a>
<a class="sourceLine" id="cb56-22" title="22"><span class="co">#&gt; Warning: Removed 6 rows containing missing values (geom_smooth).</span></a></code></pre></div>
<p><img src="Rbook_files/figure-html/axis%20limits-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Notice the warning messages we get, telling us that n rows contain either missing or non-finite values? That’s because we’ve essentially chopped out a huge part of our data using this method (everything outside of the ranges that we specified). As a result of doing this our lines have no completely changed direction. Notice that for low nitrogen concentration, the line is being drawn using only two points? This may, or may not be a problem depending on the aim we have, but we can use an alternative method; <code>coord_cartesian()</code>.</p>
<p><code>coord_cartesian()</code> works in much the same way, but instead of chopping out data, it instead zooms in. Doing so means that the entire dataset is maintained (and any trends are maintained).</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen, <span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.7833</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-9" title="9"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb57-10" title="10">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-11" title="11"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">21</span>),</a>
<a class="sourceLine" id="cb57-12" title="12">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-13" title="13"><span class="st">    </span><span class="kw">theme_rbook</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb57-14" title="14"><span class="st">    </span></a>
<a class="sourceLine" id="cb57-15" title="15"><span class="st">    </span><span class="co"># Zooming in rather than chopping out</span></a>
<a class="sourceLine" id="cb57-16" title="16"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">15</span>),   <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">150</span>))</a></code></pre></div>
<p><img src="Rbook_files/figure-html/coord_cartesian-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Notice now that the trends are maintained (as the lines are being informed by data which are off-screen). I would generally advise using <code>coord_cartesian()</code> as it protects you against possible misinterpretations.</p>
</div>
<div id="layering-layers" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Layering layers</h3>
<p>Remember that <code>ggplot2</code> works like painting. Let’s imagine we were one of the great renaissance painters. We’ve just finished the focal point of our painting, the half naked Duke of Toulouse looking moody or something. Now that we’ve finished painting the honourable Duke, we proceed to paint the background, a beautiful landscape showing the Pyrenees mountains in the distance. Unfortunately, in doing so we’ve painted over the Duke, because the order of our layers were wrong. We get our heads chopped off, but learn a valuable lesson in the process: the order of layers matter.</p>
<p>The exact same is true in <code>ggplot2</code> (minus the chopping off of heads, though your situation may vary). The layers are read and “painted” in order of their appearance in the code. If <code>geom_point()</code> comes before <code>geom_col()</code>, then your points may well end up being hidden. To fix this is especially easy, we simply need to move the layers up or down in the code. A useful tip for those using Rstudio, is that you can do move lines of code especially easily. Simply click on a line of code, hold down Alt and then press either the up or down arrows, and the entire line will move up or down as well. For multiple lines of code, simply highlight all those lines you want to move and press Alt + Up/Down.</p>
<p>We’ll move both the points and the Overall black dashed line down in the code so that they are superimposed over the nitrogen lines:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="st">    </span></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="st">    </span><span class="co"># Move one line down</span></a>
<a class="sourceLine" id="cb58-5" title="5"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen, <span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-6" title="6"><span class="st">    </span></a>
<a class="sourceLine" id="cb58-7" title="7"><span class="st">    </span><span class="co"># Moved one line down</span></a>
<a class="sourceLine" id="cb58-8" title="8"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-9" title="9"><span class="st">    </span></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-11" title="11"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-12" title="12"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.7833</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-13" title="13"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-14" title="14"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb58-15" title="15">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-16" title="16"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">21</span>),</a>
<a class="sourceLine" id="cb58-17" title="17">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-18" title="18"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/layering%20layers-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>It’s not the clearest example, but give it a shot with your own data.</p>
</div>
<div id="moving-the-legend" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Moving the legend</h3>
<p>To move the position of the legend requires tweaking the theme, just as we did before with <code>theme_rbook()</code>. But for legends we might not want this set as a hard rule whenever we use the theme (i.e. coding this into <code>theme_rbook()</code>). Instead we can change it on the fly depending on the individual figure. To do so, we can use a <code>theme()</code> layer and the argument <code>legend.position =</code>, followed swiftly by a layer specifying that we still want to use <code>theme_rbook()</code>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-8" title="8"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-9" title="9"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb59-10" title="10">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-11" title="11"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb59-12" title="12">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-13" title="13"><span class="st">    </span></a>
<a class="sourceLine" id="cb59-14" title="14"><span class="st">    </span><span class="co"># Moving the legend</span></a>
<a class="sourceLine" id="cb59-15" title="15"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-16" title="16"><span class="st">    </span></a>
<a class="sourceLine" id="cb59-17" title="17"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/moving%20legend-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><em>Play around</em>: Try the above code but don’t include <code>theme_rbook()</code> and see what happens? What about if you try <code>theme_rbook(legend.position = "bottom")</code>?</p>
</div>
<div id="hiding-the-legend" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Hiding the legend</h3>
<p>Suppose we don’t want a legend at all. How would we go about hiding it?</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-8" title="8"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-9" title="9"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb60-10" title="10">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-11" title="11"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb60-12" title="12">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-13" title="13"><span class="st">    </span></a>
<a class="sourceLine" id="cb60-14" title="14"><span class="st">    </span><span class="co"># Hiding the legend</span></a>
<a class="sourceLine" id="cb60-15" title="15"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb60-16" title="16"><span class="st">    </span></a>
<a class="sourceLine" id="cb60-17" title="17"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/hiding%20legend-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="hiding-part-of-the-legend" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Hiding part of the legend</h3>
<p>What if we really don’t want points included in the legend? Instead of stating this using <code>theme()</code>, we’ll include it within <code>geom_point()</code> using <code>show.legend = FALSE</code>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="st">    </span></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="st">    </span><span class="co"># Including show.legend = FALSE to prevent inclusion in legend</span></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-5" title="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-7" title="7"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-8" title="8"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-9" title="9"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-10" title="10"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-11" title="11"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-12" title="12"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb61-13" title="13">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-14" title="14"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb61-15" title="15">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb61-16" title="16"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/hiding%20part%20of%20legend-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="writing-on-a-figure" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Writing on a figure</h3>
<p>What if we were so utterly proud of our figure that we wanted to sign it (just like a painter signs their works of art)? We can do this using <code>geom_text()</code>. If we want to change the font, we need to check which ones are available for us to use. We can check this by runnings <code>windowsFonts()</code>. We’ll use Times New Roman in this example, which is referred to as <code>serif</code>.</p>
<p>Not happy with your font options? Check our the <code>extrafont</code> package which expands your fontage.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-8" title="8"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb62-10" title="10">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-11" title="11"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb62-12" title="12">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-13" title="13"><span class="st">    </span></a>
<a class="sourceLine" id="cb62-14" title="14"><span class="st">    </span><span class="co"># Including layer to display text</span></a>
<a class="sourceLine" id="cb62-15" title="15"><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">22</span>, <span class="dt">y =</span> <span class="dv">5</span>, <span class="dt">label =</span> <span class="st">&quot;A. Artist&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb62-16" title="16"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/geom_text-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>In reality there are more appropriate uses for <code>geom_text()</code> but whatever the reason, the mechanics remain the same. We specify what the x and y position are (on the scales of the axes), what we want written (using <code>label =</code>), the font (using <code>family =</code>).</p>
<p>Similarly, we want to include a tag for the figure, for instance we may want to refer to this figure as A if we had nested figures. We can do this using an additional argument in <code>labs()</code>. Let’s see how that works:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-7" title="7"><span class="st">    </span></a>
<a class="sourceLine" id="cb63-8" title="8"><span class="st">    </span><span class="co"># Including tag argument</span></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>, <span class="dt">tag =</span> <span class="st">&quot;A&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-10" title="10"><span class="st">    </span></a>
<a class="sourceLine" id="cb63-11" title="11"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-12" title="12"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb63-13" title="13">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-14" title="14"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb63-15" title="15">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb63-16" title="16"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/tag%20A-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Doing so we get an “A” at the top left of the figure. If we weren’t happy with the position of the “A”, we can always use <code>geom_text()</code> instead and position it ourselves.</p>
</div>
<div id="tick-for-tack" class="section level3">
<h3><span class="header-section-number">4.3.7</span> Tick for tack</h3>
<p>Axis ticks sometimes need to be rotated. If you’ve ever worked with data from multiple species (with those lovely long latin names), you’ll know that it can be a nightmare making summary statistics. The names can end up overlapping to such an extent that you axis tick labels merge into a giant black blob of unreadable abstractionism. In such cases it’s best to rotate the text to make it readable. Doing so isn’t too much of a pain and we’ll be using <code>theme()</code> to set angle to 45 degress in addition to a little vertical adjustment so that the text doesn’t get too close or run too far away from the axis.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea, <span class="dt">colour =</span> nitrogen), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> nitrogen), <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-5" title="5"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Weight of flower (g)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-6" title="6"><span class="st">    </span><span class="kw">ylab</span>(<span class="kw">bquote</span>(<span class="st">&quot;Area of shoot&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-7" title="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">shape =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Lines are only to suggest trends&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-8" title="8"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">79.8</span>), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-9" title="9"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5C1AAE&quot;</span>, <span class="st">&quot;#AE5C1A&quot;</span>, <span class="st">&quot;#1AAE5C&quot;</span>),</a>
<a class="sourceLine" id="cb64-10" title="10">                                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-11" title="11"><span class="st">    </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">19</span>),</a>
<a class="sourceLine" id="cb64-12" title="12">                                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-13" title="13"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb64-14" title="14"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/rotate%20axis-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Phew. Now we can really read those numbers. Granted rotating the axis text here isn’t needed, but keep this trick in mind if you have lots of levels in a factor which leads to illegible blobs.</p>
<p>To round off this chapter, I will take you on a whistle-stop tour of some of the common types of plots you can make in the aptly named Beastiary section (which is totally different from a Bestiary).</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-start-of-the-end.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-ggplot-beastiary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexd106/Rbook/edit/master/04-graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
