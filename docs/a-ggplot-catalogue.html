<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 A ggplot catalogue | A Introduction to R</title>
  <meta name="description" content="An Introduction to R" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 A ggplot catalogue | A Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to R" />
  <meta name="github-repo" content="alexd106/Rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 A ggplot catalogue | A Introduction to R" />
  
  <meta name="twitter:description" content="An Introduction to R" />
  

<meta name="author" content="Alex Douglas, Francesca Mancini, Deon Roos, Ana Couto &amp; David Lusseau" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tips-and-tricks.html"/>
<link rel="next" href="stats-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="the-aim-of-this-book.html"><a href="the-aim-of-this-book.html"><i class="fa fa-check"></i><b>0.1</b> The aim of this book</a></li>
<li class="chapter" data-level="0.2" data-path="why-an-open-book.html"><a href="why-an-open-book.html"><i class="fa fa-check"></i><b>0.2</b> Why an open book?</a></li>
<li class="chapter" data-level="0.3" data-path="book-website.html"><a href="book-website.html"><i class="fa fa-check"></i><b>0.3</b> Book website</a></li>
<li class="chapter" data-level="0.4" data-path="some-r-pointers.html"><a href="some-r-pointers.html"><i class="fa fa-check"></i><b>0.4</b> Some R pointers</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started-with-r-and-rstudio.html"><a href="getting-started-with-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting started with R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="install-r.html"><a href="install-r.html"><i class="fa fa-check"></i><b>1.1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="install-r.html"><a href="install-r.html#windows-users"><i class="fa fa-check"></i><b>1.1.1</b> Windows users</a></li>
<li class="chapter" data-level="1.1.2" data-path="install-r.html"><a href="install-r.html#mac-users"><i class="fa fa-check"></i><b>1.1.2</b> Mac users</a></li>
<li class="chapter" data-level="1.1.3" data-path="install-r.html"><a href="install-r.html#linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Linux users</a></li>
<li class="chapter" data-level="1.1.4" data-path="install-r.html"><a href="install-r.html#testing-r"><i class="fa fa-check"></i><b>1.1.4</b> Testing R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="installing-rstudio.html"><a href="installing-rstudio.html#windows-and-mac-users"><i class="fa fa-check"></i><b>1.2.1</b> Windows and Mac users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html#linux-users-1"><i class="fa fa-check"></i><b>1.2.2</b> Linux users</a></li>
<li class="chapter" data-level="1.2.3" data-path="installing-rstudio.html"><a href="installing-rstudio.html#testing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Testing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html"><i class="fa fa-check"></i><b>1.3</b> RStudio orientation</a><ul>
<li class="chapter" data-level="1.3.1" data-path="rstudio-orient.html"><a href="rstudio-orient.html#console"><i class="fa fa-check"></i><b>1.3.1</b> Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="rstudio-orient.html"><a href="rstudio-orient.html#environment-history-files"><i class="fa fa-check"></i><b>1.3.2</b> Environment / History / Files</a></li>
<li class="chapter" data-level="1.3.3" data-path="rstudio-orient.html"><a href="rstudio-orient.html#plots-help-viewer"><i class="fa fa-check"></i><b>1.3.3</b> Plots / Help / Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html"><i class="fa fa-check"></i><b>1.4</b> Alternatives to RStudio</a></li>
<li class="chapter" data-level="1.5" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>1.5</b> R packages</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-packages.html"><a href="r-packages.html#cran_packages"><i class="fa fa-check"></i><b>1.5.1</b> CRAN packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-packages.html"><a href="r-packages.html#bioconductor-packages"><i class="fa fa-check"></i><b>1.5.2</b> Bioconductor packages</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-packages.html"><a href="r-packages.html#github-packages"><i class="fa fa-check"></i><b>1.5.3</b> GitHub packages</a></li>
<li class="chapter" data-level="1.5.4" data-path="r-packages.html"><a href="r-packages.html#using-packages"><i class="fa fa-check"></i><b>1.5.4</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="writing-r-code.html"><a href="writing-r-code.html"><i class="fa fa-check"></i><b>1.6</b> Writing R code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-r.html"><a href="basics-r.html"><i class="fa fa-check"></i><b>2</b> Some R Basics</a></li>
<li class="chapter" data-level="3" data-path="data-r.html"><a href="data-r.html"><i class="fa fa-check"></i><b>3</b> Data in R</a></li>
<li class="chapter" data-level="4" data-path="graphics-r.html"><a href="graphics-r.html"><i class="fa fa-check"></i><b>4</b> Graphics in R</a><ul>
<li class="chapter" data-level="4.1" data-path="beginning-at-the-end.html"><a href="beginning-at-the-end.html"><i class="fa fa-check"></i><b>4.1</b> Beginning at the end</a></li>
<li class="chapter" data-level="4.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html"><i class="fa fa-check"></i><b>4.2</b> The start of the end</a><ul>
<li class="chapter" data-level="4.2.1" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#the-purest-of-ggplots"><i class="fa fa-check"></i><b>4.2.1</b> The purest of ggplots</a></li>
<li class="chapter" data-level="4.2.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#wrapping-grids"><i class="fa fa-check"></i><b>4.2.2</b> Wrapping grids</a></li>
<li class="chapter" data-level="4.2.3" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#plotting-multiple-ggplots"><i class="fa fa-check"></i><b>4.2.3</b> Plotting multiple ggplots</a></li>
<li class="chapter" data-level="4.2.4" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#make-it-your-own"><i class="fa fa-check"></i><b>4.2.4</b> Make it your own</a></li>
<li class="chapter" data-level="4.2.5" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#setting-the-theme"><i class="fa fa-check"></i><b>4.2.5</b> Setting the theme</a></li>
<li class="chapter" data-level="4.2.6" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#prettification"><i class="fa fa-check"></i><b>4.2.6</b> Prettification</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html"><i class="fa fa-check"></i><b>4.3</b> Tips and tricks</a><ul>
<li class="chapter" data-level="4.3.1" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#axis-limits-and-zooms"><i class="fa fa-check"></i><b>4.3.1</b> Axis limits and zooms</a></li>
<li class="chapter" data-level="4.3.2" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#layering-layers"><i class="fa fa-check"></i><b>4.3.2</b> Layering layers</a></li>
<li class="chapter" data-level="4.3.3" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#continuous-colours"><i class="fa fa-check"></i><b>4.3.3</b> Continuous colours</a></li>
<li class="chapter" data-level="4.3.4" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#size-of-points"><i class="fa fa-check"></i><b>4.3.4</b> Size of points</a></li>
<li class="chapter" data-level="4.3.5" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#moving-the-legend"><i class="fa fa-check"></i><b>4.3.5</b> Moving the legend</a></li>
<li class="chapter" data-level="4.3.6" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#hiding-the-legend"><i class="fa fa-check"></i><b>4.3.6</b> Hiding the legend</a></li>
<li class="chapter" data-level="4.3.7" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#hiding-part-of-the-legend"><i class="fa fa-check"></i><b>4.3.7</b> Hiding part of the legend</a></li>
<li class="chapter" data-level="4.3.8" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#writing-on-a-figure"><i class="fa fa-check"></i><b>4.3.8</b> Writing on a figure</a></li>
<li class="chapter" data-level="4.3.9" data-path="tips-and-tricks.html"><a href="tips-and-tricks.html#ticks-and-tick-labels"><i class="fa fa-check"></i><b>4.3.9</b> Ticks and tick labels</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html"><i class="fa fa-check"></i><b>4.4</b> A ggplot catalogue</a><ul>
<li class="chapter" data-level="4.4.1" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#density-plot"><i class="fa fa-check"></i><b>4.4.1</b> Density plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#histogram"><i class="fa fa-check"></i><b>4.4.2</b> Histogram</a></li>
<li class="chapter" data-level="4.4.3" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#frequency-polygons"><i class="fa fa-check"></i><b>4.4.3</b> Frequency polygons</a></li>
<li class="chapter" data-level="4.4.4" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#boxplot"><i class="fa fa-check"></i><b>4.4.4</b> Boxplot</a></li>
<li class="chapter" data-level="4.4.5" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#violin-plots"><i class="fa fa-check"></i><b>4.4.5</b> Violin plots</a></li>
<li class="chapter" data-level="4.4.6" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#barchart"><i class="fa fa-check"></i><b>4.4.6</b> Barchart</a></li>
<li class="chapter" data-level="4.4.7" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#quantile-lines"><i class="fa fa-check"></i><b>4.4.7</b> Quantile lines</a></li>
<li class="chapter" data-level="4.4.8" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#heatmap"><i class="fa fa-check"></i><b>4.4.8</b> Heatmap</a></li>
<li class="chapter" data-level="4.4.9" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#hex-map"><i class="fa fa-check"></i><b>4.4.9</b> Hex map</a></li>
<li class="chapter" data-level="4.4.10" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#contour-map"><i class="fa fa-check"></i><b>4.4.10</b> Contour map</a></li>
<li class="chapter" data-level="4.4.11" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#cleveland-dotplot"><i class="fa fa-check"></i><b>4.4.11</b> Cleveland dotplot</a></li>
<li class="chapter" data-level="4.4.12" data-path="a-ggplot-catalogue.html"><a href="a-ggplot-catalogue.html#pairs-plot"><i class="fa fa-check"></i><b>4.4.12</b> Pairs plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats-r.html"><a href="stats-r.html"><i class="fa fa-check"></i><b>5</b> Simple Statistics in R</a></li>
<li class="chapter" data-level="6" data-path="prog-r.html"><a href="prog-r.html"><i class="fa fa-check"></i><b>6</b> Programming in R</a></li>
<li class="chapter" data-level="7" data-path="rmarkdown-r.html"><a href="rmarkdown-r.html"><i class="fa fa-check"></i><b>7</b> Reproducible reports</a><ul>
<li class="chapter" data-level="7.1" data-path="what-is-r-markdown.html"><a href="what-is-r-markdown.html"><i class="fa fa-check"></i><b>7.1</b> What is R markdown?</a></li>
<li class="chapter" data-level="7.2" data-path="why-use-r-markdown.html"><a href="why-use-r-markdown.html"><i class="fa fa-check"></i><b>7.2</b> Why use R markdown?</a></li>
<li class="chapter" data-level="7.3" data-path="getting-started-with-r-markdown.html"><a href="getting-started-with-r-markdown.html"><i class="fa fa-check"></i><b>7.3</b> Getting started with R markdown</a></li>
<li class="chapter" data-level="7.4" data-path="new-rm.html"><a href="new-rm.html"><i class="fa fa-check"></i><b>7.4</b> Creating an R markdown document</a></li>
<li class="chapter" data-level="7.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html"><i class="fa fa-check"></i><b>7.5</b> R markdown anatomy</a><ul>
<li class="chapter" data-level="7.5.1" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#yaml-header"><i class="fa fa-check"></i><b>7.5.1</b> YAML header</a></li>
<li class="chapter" data-level="7.5.2" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#formatted-text"><i class="fa fa-check"></i><b>7.5.2</b> Formatted text</a></li>
<li class="chapter" data-level="7.5.3" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#code_chunks"><i class="fa fa-check"></i><b>7.5.3</b> Code chunks</a></li>
<li class="chapter" data-level="7.5.4" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-figures"><i class="fa fa-check"></i><b>7.5.4</b> Adding figures</a></li>
<li class="chapter" data-level="7.5.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-tables"><i class="fa fa-check"></i><b>7.5.5</b> Adding tables</a></li>
<li class="chapter" data-level="7.5.6" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#inline-r-code"><i class="fa fa-check"></i><b>7.5.6</b> Inline R code</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tips-tricks.html"><a href="tips-tricks.html"><i class="fa fa-check"></i><b>7.6</b> Some tips and tricks</a></li>
<li class="chapter" data-level="7.7" data-path="further-information.html"><a href="further-information.html"><i class="fa fa-check"></i><b>7.7</b> Further Information</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="github-r.html"><a href="github-r.html"><i class="fa fa-check"></i><b>8</b> Version control with Git and GitHub</a><ul>
<li class="chapter" data-level="8.1" data-path="setup-git.html"><a href="setup-git.html"><i class="fa fa-check"></i><b>8.1</b> Getting started with git</a><ul>
<li class="chapter" data-level="8.1.1" data-path="setup-git.html"><a href="setup-git.html#configure-git"><i class="fa fa-check"></i><b>8.1.1</b> Configure git</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="rstudio-git.html"><a href="rstudio-git.html"><i class="fa fa-check"></i><b>8.2</b> Version control with RStudio and Git</a><ul>
<li class="chapter" data-level="8.2.1" data-path="rstudio-git.html"><a href="rstudio-git.html#setting-up-a-version-controlled-project-in-rstudio"><i class="fa fa-check"></i><b>8.2.1</b> Setting up a version controlled project in RStudio</a></li>
<li class="chapter" data-level="8.2.2" data-path="rstudio-git.html"><a href="rstudio-git.html#making-changes"><i class="fa fa-check"></i><b>8.2.2</b> Making changes</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>8.3</b> Setting up a remote repository on GitHub</a><ul>
<li class="chapter" data-level="8.3.1" data-path="github.html"><a href="github.html#new_repo"><i class="fa fa-check"></i><b>8.3.1</b> Create a new repository</a></li>
<li class="chapter" data-level="8.3.2" data-path="github.html"><a href="github.html#pull_push"><i class="fa fa-check"></i><b>8.3.2</b> Pulling and pushing changes</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="vc-workflow.html"><a href="vc-workflow.html"><i class="fa fa-check"></i><b>8.4</b> A version control workflow</a></li>
<li class="chapter" data-level="8.5" data-path="command-line.html"><a href="command-line.html"><i class="fa fa-check"></i><b>8.5</b> Using git from the command line</a><ul>
<li class="chapter" data-level="8.5.1" data-path="command-line.html"><a href="command-line.html#setting-up-a-git-repository"><i class="fa fa-check"></i><b>8.5.1</b> Setting up a git repository</a></li>
<li class="chapter" data-level="8.5.2" data-path="command-line.html"><a href="command-line.html#staging-files-and-first-commit"><i class="fa fa-check"></i><b>8.5.2</b> Staging files and first commit</a></li>
<li class="chapter" data-level="8.5.3" data-path="command-line.html"><a href="command-line.html#connecting-to-a-remote-repository"><i class="fa fa-check"></i><b>8.5.3</b> Connecting to a remote repository</a></li>
<li class="chapter" data-level="8.5.4" data-path="command-line.html"><a href="command-line.html#the-workflow"><i class="fa fa-check"></i><b>8.5.4</b> The workflow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>9</b> Appendix</a><ul>
<li class="chapter" data-level="9.1" data-path="install-rm.html"><a href="install-rm.html"><i class="fa fa-check"></i><b>9.1</b> Installing R Markdown on a compter running MS Windows</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-ggplot-catalogue" class="section level2">
<h2><span class="header-section-number">4.4</span> A ggplot catalogue</h2>
<p>What follows is a quick run through of example <code>ggplots</code>. These will predominantly be done by changing the geoms used, but there will be additional slight tweaks which I’ll highlight.</p>
<div id="density-plot" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Density plot</h3>
<p>Below is a density plot which is much like a histogram. The x axis shows observations of given numbers of flowers, while the y axis is the density of observations (roughly equivalent to number of rows with that many flowers). Each density is coloured according to nitrogen concentration, though note that we’re using <code>fill =</code> instead of <code>colour =</code>. Try using colour instead to see what happens.</p>
<p>Notice that we haven’t used <code>data = flowers</code> here and instead just used <code>flowers</code>? When an object is not assigned with an argument, <code>ggplot2</code> will assume that it is the dataset. We’re using that here, but I actually prefer to explicitly state what arguments are being fulfilled in my own work.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="kw">ggplot</span>(flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">x =</span> flowers, <span class="dt">fill =</span> nitrogen), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Nitrogen</span><span class="ch">\n</span><span class="st">Concentration&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-4" data-line-number="4"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>),</a>
<a class="sourceLine" id="cb72-5" data-line-number="5">                                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#DB24BC&quot;</span>, <span class="st">&quot;#BCDB24&quot;</span>, <span class="st">&quot;#24BCDB&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-6" data-line-number="6"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/density%20plot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="histogram" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Histogram</h3>
<p>Next is a histogram (a much more traditional version of a density plot). There are a couple of things to take note of here. The first is that <code>flower$block</code> is numeric and not a factor. We can correct that here fairly easily using the <code>factor()</code> function to convert it from numeric to factor (though ideally we’d have done this before - see Chapter 3). The other thing to take note of is that I’ve specified <code>bins = 20</code>. The number of bins control how many times the y-axis is broken up to show the data. Try increasing and decreasing to see the effect.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">ggplot</span>(flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> flowers, <span class="dt">fill =</span> <span class="kw">factor</span>(block)), <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Greenhouse</span><span class="ch">\n</span><span class="st">Block&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>),</a>
<a class="sourceLine" id="cb73-5" data-line-number="5">                                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#8CD926&quot;</span>, <span class="st">&quot;#7326D9&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># HULK SMASH!</span></a>
<a class="sourceLine" id="cb73-6" data-line-number="6"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/histogram-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="frequency-polygons" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Frequency polygons</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw">ggplot</span>(flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_freqpoly</span>(<span class="kw">aes</span>(<span class="dt">x =</span> flowers, <span class="dt">colour =</span> <span class="kw">factor</span>(block)), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Greenhouse</span><span class="ch">\n</span><span class="st">Block&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-4" data-line-number="4"><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>),</a>
<a class="sourceLine" id="cb74-5" data-line-number="5">                                            <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#8CD926&quot;</span>, <span class="st">&quot;#7326D9&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># HULK SMASH!</span></a>
<a class="sourceLine" id="cb74-6" data-line-number="6"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/freqpoly-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="boxplot" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Boxplot</h3>
<p>Boxplots are a classic way to show to spread of data, and they’re easy to make in <code>ggplot2</code>. The dark line in the middle of the box shows the median, the boxes show the 25th and 75th percentiles (which is different from the base R <code>boxplot()</code>), and the whiskers show 1.5 times the inter-quartile range (i.e. the distance between between the first and third quartiles). We can also make the boxes notched using the argument <code>notch = TRUE</code>. Notches extend (1.58 times the inter-quartile range) / square root of the number of observations. If notches do no overlap, it suggest (but only suggests) there may be a significant difference between groups.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">ggplot</span>(flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> flowers, <span class="dt">x =</span> nitrogen), <span class="dt">notch =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb75-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Nitrogen Concentration&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb75-4" data-line-number="4"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/boxplot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="violin-plots" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Violin plots</h3>
<p>Violin plots are an increasingly popular alternative to boxplots. They display much of the same information, as well as showing a version of the density plot above (imagine each violin plot, cut in half vertically, showing the overall distribution of the data). In the plot below the figure is slightly more complex than those above and so deserves some explanation.</p>
<p>Within <code>geom_violin()</code> we’ve included <code>draw_quantiles =</code> where we’ve specified we want quantile lines drawn at the 25, 50 and 75 quantiles (using the <code>c()</code> function). In combination with <code>geom_violin()</code> we’ve also included <code>geom_jitter()</code>. <code>geom_jitter()</code> is similar to <code>geom_point()</code> but induces random spread of the points, often helpful when points would otherwise be clustered. Within <code>geom_jitter()</code> we’ve also set <code>height = 0</code>, and <code>width = 0.1</code> which specifies how much to jitter the points in a given dimension (here essentially telling <code>ggplot2</code> not to jitter by height, and only to jitter width by a small amount).</p>
<p>Finally, I’m also using this plot to show <code>scale_y_log10</code>. Hopefully this is largely self-explanatory (it converts the y-axis to the log10 scale). There are additional scaling options for axis (for instance <code>scale_y_sqrt()</code>). Please note that using a log scaled axis in this case is actually doing harm, in terms of understanding the data, we’d be much better off not doing so in this particular case.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">ggplot</span>(flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">y =</span> flowers, <span class="dt">x =</span> nitrogen, <span class="dt">fill =</span> nitrogen), <span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">y =</span> flowers, <span class="dt">x =</span> nitrogen), <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb76-4" data-line-number="4"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>),</a>
<a class="sourceLine" id="cb76-5" data-line-number="5">                                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#5f7f5c&quot;</span>, <span class="st">&quot;#749770&quot;</span>, <span class="st">&quot;#9eb69b&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb76-6" data-line-number="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Number of Flowers&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Nitrogen Concentration&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb76-7" data-line-number="7"><span class="st">    </span><span class="kw">scale_y_log10</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb76-8" data-line-number="8"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/violin%20plot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="barchart" class="section level3">
<h3><span class="header-section-number">4.4.6</span> Barchart</h3>
<p>Below is an example of barcharts. It is included here for completeness, but be aware that they are viewed with contention (see here for a discussion of why <strong><em>LINK</em></strong>). Briefly, there are almost always better alternatives to use that better demonstrate the trends.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">ggplot</span>(flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(block), <span class="dt">fill =</span> nitrogen)) <span class="op">+</span></a>
<a class="sourceLine" id="cb77-3" data-line-number="3"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;High&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Low&quot;</span>),</a>
<a class="sourceLine" id="cb77-4" data-line-number="4">                                        <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#2613EC&quot;</span>, <span class="st">&quot;#9313EC&quot;</span>, <span class="st">&quot;#EC13D9&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb77-5" data-line-number="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Count&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Block&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb77-6" data-line-number="6"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/barchart-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The barchart shows the numbers of observations in each block, with each bar split according to the number of observations in each nitrogen concentration. In this case they are equal because the dataset (and experimental design) was balanced.</p>
</div>
<div id="quantile-lines" class="section level3">
<h3><span class="header-section-number">4.4.7</span> Quantile lines</h3>
<p>While we can draw a straight line, perhaps we would also like to include the descriptive nature of a boxplot, except using continuous data. We can use quantile lines in such cases. Note that for quantiles to be calculated <code>ggplot2</code> requires the installation of the package <code>quantreg</code>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-3" data-line-number="3"><span class="st">    </span><span class="kw">geom_quantile</span>(<span class="dt">colour =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-4" data-line-number="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Weight&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="st">    </span><span class="kw">theme_rbook</span>()</a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="co">#&gt; Smoothing formula not specified. Using: y ~ x</span></a></code></pre></div>
<p><img src="Rbook_files/figure-html/quantile%20lines-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="heatmap" class="section level3">
<h3><span class="header-section-number">4.4.8</span> Heatmap</h3>
<p>When using spatial data, heatmaps can be a great tool to visual spatial patterns. <code>ggplot2</code> can easily handle such data using <code>geom_bin2d()</code>. Even when not using spatial data, the figure can allow us to see if our data is more (or less) clustered.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> leafarea, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_bin2d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb79-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb79-4" data-line-number="4"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb79-5" data-line-number="5"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/heat-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>In this example, lighter blue squares show combinations of leaf area and shoot area where we have more data, and dark blue shows the converse.</p>
</div>
<div id="hex-map" class="section level3">
<h3><span class="header-section-number">4.4.9</span> Hex map</h3>
<p>A similar version to <code>geom_density2d()</code> is <code>geom_hex()</code>. The only difference between the two is that the sqaures are replaced with hexagons. Note that <code>geom_hex()</code> requires an additional package called <code>hexbin</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> leafarea, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_hex</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb80-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-4" data-line-number="4"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-5" data-line-number="5"><span class="st">    </span><span class="kw">theme_rbook</span>()</a>
<a class="sourceLine" id="cb80-6" data-line-number="6"><span class="co">#&gt; Warning: Computation failed in `stat_binhex()`:</span></a>
<a class="sourceLine" id="cb80-7" data-line-number="7"><span class="co">#&gt; Package `hexbin` required for `stat_binhex`.</span></a>
<a class="sourceLine" id="cb80-8" data-line-number="8"><span class="co">#&gt; Please install and try again.</span></a></code></pre></div>
<p><img src="Rbook_files/figure-html/hex-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="contour-map" class="section level3">
<h3><span class="header-section-number">4.4.10</span> Contour map</h3>
<p>Similar to a heatmap we can make a contour map using <code>geom_density_2d()</code>. The way to read this figure is much the same way as you’d read a topographical map showing “mountains” or peaks. The central polygon represents the space (amongst shoot and leaf area) where there are most observations. As you “step” down this mountain to the next line, we step down in the number of counts. Think of this as showing where points are most clustered, as in <code>geom_bin2d()</code>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> leafarea, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_density2d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-4" data-line-number="4"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-5" data-line-number="5"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/contour-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can then expand on this using <code>stat()</code>. In the background of <code>ggplot2</code> values are calculated which are then passed to some geoms. <code>stat()</code> acts like a flag to <code>ggplot2</code> that you want to use one of these calculated values. For instance, we can use the calculated “level” and use this to fill in our figure. To do so, we’ll swap out <code>geom_density_2d()</code> for <code>stat_density_2d()</code> which will allow us to paint the contour map.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> leafarea, <span class="dt">y =</span> shootarea), <span class="dt">data =</span> flower) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="st">    </span><span class="kw">stat_density_2d</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">stat</span>(level)), <span class="dt">geom =</span> <span class="st">&quot;polygon&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Shoot Area&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Leaf Area&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-4" data-line-number="4"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-5" data-line-number="5"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/stat%20contour-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>In this case it doesn’t look too pretty given that we don’t have a wide spread of data (as we would hope for with spatial data) leading to partly formed polygons.</p>
</div>
<div id="cleveland-dotplot" class="section level3">
<h3><span class="header-section-number">4.4.11</span> Cleveland dotplot</h3>
<p>The cleveland dotplot is a figure well suited to detect outliers in the data. The y axis is simply the order in which the data appears in the dataset. The x axis is our variable of interest. Points far to the left or far to the right are indicative of outliers. <code>ggplot2</code> does not have a geom specifically designed for a cleveland dotplot, though we can bend <code>ggplot2</code> to our will. We do this by first using the function <code>rownames()</code>. This function returns the row name of each row. In most dataframes, the row names are simply numbers. Once we have this information, we can convert this to numbers using <code>as.numeric()</code>. Once this is done, we essentially have a vector of numbers from 1 to 96. Keep in mind that such techniques can be used for any sort of figure we want to make.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">ggplot</span>(flower) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> leafarea, <span class="dt">y =</span> <span class="kw">as.numeric</span>(<span class="kw">rownames</span>(flower)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb83-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Order in Dataset&quot;</span>, <span class="dt">x =</span> <span class="kw">bquote</span>(<span class="st">&quot;Area of leaf&quot;</span><span class="op">~</span>(cm<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb83-4" data-line-number="4"><span class="st">    </span><span class="kw">theme_rbook</span>()</a></code></pre></div>
<p><img src="Rbook_files/figure-html/dotpot-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="pairs-plot" class="section level3">
<h3><span class="header-section-number">4.4.12</span> Pairs plot</h3>
<p>For this next figure we will need an additional package, called <code>GGally</code>. Within <code>GGally</code> is a function called <code>ggpairs()</code> which is equivalent to <code>pairs()</code> (part of base R). Both function produce comparative plots of all variables of interest. Running diagonally down from left to right, are plots showing distributions; either as stacked barcharts or as density plots, in this case coloured according to nitrogen concentration. The bottom plots show the plotted relationships, with variables on the top as the x axis, and the variables on the right plotted as the y axis. For example, the very bottom left plots shows the relationship between number of flowers on the y axis and treatment on the x axis, coloured according to nitrogen concentration. Conversely, the upper plots show either the correlation between variables, when both variables are continuous and the correlation can be calculated, boxplots when the plot is of a factor variable and a continuous variable, or as a stacked barchart when both variables are factors.</p>
<p>Such figures are a fantastic way to quickly show relationships in the dataset. They can of course be used to plot only part of the dataset, for instance using <code>flowers[ , 1:5]</code> to plot the first five columns of the dataset.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="co">#&gt; Registered S3 method overwritten by &#39;GGally&#39;:</span></a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="co">#&gt;   method from   </span></a>
<a class="sourceLine" id="cb84-4" data-line-number="4"><span class="co">#&gt;   +.gg   ggplot2</span></a>
<a class="sourceLine" id="cb84-5" data-line-number="5"></a>
<a class="sourceLine" id="cb84-6" data-line-number="6">flower<span class="op">$</span>block &lt;-<span class="st"> </span><span class="kw">factor</span>(flower<span class="op">$</span>block)</a>
<a class="sourceLine" id="cb84-7" data-line-number="7"></a>
<a class="sourceLine" id="cb84-8" data-line-number="8"><span class="kw">ggpairs</span>(flower, ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">colour =</span> nitrogen)) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-9" data-line-number="9"><span class="st">    </span><span class="kw">theme_rbook</span>()</a>
<a class="sourceLine" id="cb84-10" data-line-number="10"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-11" data-line-number="11"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-12" data-line-number="12"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-13" data-line-number="13"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-14" data-line-number="14"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-15" data-line-number="15"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-16" data-line-number="16"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-17" data-line-number="17"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-18" data-line-number="18"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-19" data-line-number="19"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-20" data-line-number="20"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-21" data-line-number="21"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-22" data-line-number="22"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-23" data-line-number="23"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a>
<a class="sourceLine" id="cb84-24" data-line-number="24"><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></a></code></pre></div>
<p><img src="Rbook_files/figure-html/pairs%20plot-1.png" width="75%" style="display: block; margin: auto;" /></p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="tips-and-tricks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stats-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/alexd106/Rbook/edit/master/04-graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
